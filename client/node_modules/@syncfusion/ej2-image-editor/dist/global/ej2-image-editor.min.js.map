{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/image-editor.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { NotifyPropertyChanges, Property, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, getInstance, isNullOrUndefined, L10n, getUniqueID } from '@syncfusion/ej2-base';\nimport { SignatureBase } from '@syncfusion/ej2-inputs';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader } from '@syncfusion/ej2-inputs';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { compile, compile as templateCompiler, Browser } from '@syncfusion/ej2-base';\n/**\n * Image Editor is a graphical user interface that helps to edit an image by performing actions like selection,\n * cropping, rotating, inserting text and shapes (rectangles, ellipses, lines), and drawing free hand on top of an image.\n *\n ```html\n * <div id='imageeditor'></div>\n * ```\n * ```typescript\n * <script>\n * var imageObj = new ImageEditor({});\n * imageObj.appendTo(\"#imageeditor\");\n * </script>\n * ```\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        _this.degree = 0; // current rotated state\n        _this.isUndoRedo = false;\n        _this.dragCanvas = false;\n        _this.dragElement = '';\n        _this.keyHistory = ''; // text history\n        _this.flipState = ''; // current flip state whether horizontal or vertical or none\n        _this.mouseDownPoint = { x: 0, y: 0 };\n        _this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        _this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        _this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        _this.oldPoint = {};\n        _this.objColl = []; // shapes, text obj collection\n        _this.undoRedoColl = [];\n        _this.imgDataColl = []; // collection of Image Data mainly used for reset state\n        _this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        _this.textSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, bold: false, italic: false, underline: false };\n        _this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        _this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, bold: false, italic: false, underline: false };\n        _this.toolbarHeight = 46;\n        _this.pannStart = {};\n        _this.pannEnd = {};\n        _this.togglePan = false;\n        _this.lastX = 0;\n        _this.lastY = 0;\n        _this.dragStart = { x: 0, y: 0 };\n        _this.dragged = false;\n        _this.factor = 1; // current zoomed state\n        _this.currFlipState = '';\n        _this.touchEndPoint = {};\n        _this.flipMethod = false;\n        _this.flipDirection = '';\n        _this.prevX = 0;\n        _this.currX = 0;\n        _this.prevY = 0;\n        _this.currY = 0;\n        _this.togglePen = false;\n        _this.rotateMethod = false;\n        _this.isBoldbtn = false;\n        _this.isItalicbtn = false;\n        _this.lastAction = '';\n        _this.currentToolbar = 'main';\n        _this.textStartPoints = { x: 0, y: 0 };\n        _this.fontSizeColl = [];\n        _this.tempKeyHistory = '';\n        _this.penDrawColl = [];\n        _this.allowDrag = false;\n        _this.textRow = 1;\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [] };\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n            isInitialLine: false, isCustomCrop: false, isZoomed: false };\n        _this.defToolbarItems = [];\n        _this.baseImgSrc = '';\n        _this.isTimer = false;\n        _this.isScreenOriented = false;\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' }\n        };\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'OK',\n            Cancel: 'Cancel',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Default: 'Default',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.locale);\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param  {ImageEditorModel} newProperties - Specifies new properties\n     * @param  {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        this.updateTheme();\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        this.unwireEvent();\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.trigger('destroyed');\n    };\n    ImageEditor.prototype.initialize = function () {\n        this.createToolbar();\n        this.createCanvas();\n        this.wireEvent();\n        this.updateContext(this.lowerContext);\n        this.updateContext(this.upperContext);\n        this.pannStart = { startX: 0, startY: 0, width: 0, height: 0 };\n        this.pannEnd = { startX: 0, startY: 0, width: 0, height: 0 };\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(document, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.upperCanvas, 'dblclick', this.findTextPoint, this);\n        EventHandler.add(this.textBox, 'mousedown', this.findTextPoint, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(document, 'mouseup', this.canvasMouseUpHandler);\n    };\n    ImageEditor.prototype.updateTheme = function () {\n        if (this.theme !== '') {\n            this.theme = this.toPascalCase(this.theme);\n        }\n    };\n    ImageEditor.prototype.toPascalCase = function (str) {\n        var strArr = str.toLowerCase().split('-');\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        return strArr.join('');\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        var height = this.toolbarHeight;\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height) + 'px; width:' +\n                    (this.element.offsetWidth)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textBox = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textBox', attrs: { name: 'textBox' }\n        }));\n        this.textBox.setAttribute('spellcheck', 'false');\n        this.upperCanvas.width = this.lowerCanvas.width = this.inMemoryCanvas.width = this.element.offsetWidth;\n        this.upperCanvas.height = this.lowerCanvas.height = this.inMemoryCanvas.height = (this.element.offsetHeight - this.toolbarHeight);\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.textBox.style.position = 'absolute';\n        this.textBox.style.backgroundColor = 'transparent';\n        this.textBox.style.display = 'none';\n        this.textBox.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = 'default';\n        this.upperCanvas.style.display = 'none';\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n    };\n    ImageEditor.prototype.createToolbar = function () {\n        var _this = this;\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            if (this.toolbarTemplate) {\n                this.toolbarTemplateFn();\n            }\n            else {\n                var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({}) };\n                if (isNullOrUndefined(this.defToolbarItems)) {\n                    this.defToolbarItems = [];\n                }\n                this.defToolbarItems.push(toolbarItems);\n                var toolbarArea = document.getElementById(this.element.id + '_toolbarArea');\n                var toolbar_1 = this.createElement('div', {\n                    id: this.element.id + '_toolbar'\n                });\n                toolbarArea.appendChild(toolbar_1);\n                var uploadItems = [\n                    {\n                        cssClass: 'e-image-upload',\n                        align: 'Left', type: 'Input',\n                        template: new Uploader({\n                            selected: function () {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                                        getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                                        getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initToolbarItem(false, Browser.isDevice);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                                        getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initToolbarItem(false, false);\n                                }\n                            }\n                        })\n                    }\n                ];\n                new Toolbar({ items: uploadItems, width: '100%',\n                    created: function () {\n                        _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                    },\n                    clicked: this.defToolbarClicked.bind(this) }, '#' + this.element.id + '_toolbar');\n                this.createLeftToolbarControls();\n            }\n            if (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar'))) {\n                this.toolbarHeight = document.getElementById(this.element.id + '_toolbar').clientHeight;\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ImageEditor.prototype.createBottomToolbar = function () {\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!this.toolbarTemplate) {\n                document.getElementById(this.element.id + '_canvasWrapper').style.height = (this.element.offsetHeight\n                    - this.toolbarHeight * 2) - 3 + 'px';\n                var toolbarArea = document.getElementById(this.element.id + '_bottomToolbarArea');\n                var toolbarElem = this.createElement('div', {\n                    id: this.element.id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ImageEditor.prototype.initBottomToolbar = function () {\n        var _this = this;\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            if (this.toolbarTemplate) {\n                this.toolbarTemplateFn();\n            }\n            else {\n                var items = this.getMainToolbarItem();\n                new Toolbar({ items: items, width: '100%',\n                    created: function () {\n                        _this.renderAnnotationBtn();\n                        _this.renderCropBtn();\n                        _this.renderTransformBtn();\n                        _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                    },\n                    clicked: this.defToolbarClicked.bind(this)\n                }, '#' + this.element.id + '_bottomToolbar');\n                if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_bottomToolbar')))) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_2 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                    toolbar_2.refreshOverflow();\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.renderReactTemplates();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    ImageEditor.prototype.getLeftToolbarItem = function (isOkBtn) {\n        var toolbarItems = [];\n        if (!isOkBtn) {\n            toolbarItems.push({ cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({}) });\n            toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: 'Position', align: 'Left' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('ZoomOut') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('ZoomIn') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getRightToolbarItem = function (isOkBtn) {\n        var toolbarItems = [];\n        if (isOkBtn) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Reset') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right', template: '<button id=\"' + this.element.id + '_saveBtn\"></button>' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getMainToolbarItem = function (isApplyOption) {\n        var toolbarItems = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Crop') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_crop', tooltipText: this.l10n.getConstant('Crop'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_cropBtn\"></button>'\n            });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Annotate') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_annotationBtn\"></button>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Transform') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_transform', tooltipText: this.l10n.getConstant('Transform'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_transformBtn\"></button>'\n            });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        if (this.factor > 1) {\n            toolbarItems = [\n                { id: this.element.id + '_pan', prefixIcon: 'e-icons e-pan', cssClass: 'top-icon e-img-pan',\n                    tooltipText: this.l10n.getConstant('Pan'), align: 'Left' }\n            ];\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.processToolbar = function (position) {\n        var toolbarItems = [];\n        if (this.toolbar) {\n            for (var i = 0, len = this.toolbar.length; i < len; i++) {\n                if (typeof (this.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(this.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(this.toolbar[i]);\n                        }\n                    }\n                    else if (this.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(this.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.isToolbar = function () {\n        return (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)\n            || !isNullOrUndefined(this.toolbarTemplate));\n    };\n    ImageEditor.prototype.initToolbarItem = function (isApplyOption, isDevice, isOkBtn) {\n        var _this = this;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn);\n            var rightItem = this.getRightToolbarItem(isOkBtn);\n            var mainItem = this.getMainToolbarItem(isApplyOption);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                this.defToolbarItems = leftItem.concat(zoomItem, rightItem);\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n            }\n            new Toolbar({\n                width: '100%',\n                items: this.defToolbarItems,\n                clicked: this.defToolbarClicked.bind(this),\n                created: function () {\n                    if (!isDevice) {\n                        _this.renderAnnotationBtn();\n                        _this.renderCropBtn();\n                        _this.renderTransformBtn();\n                    }\n                    _this.renderSaveBtn();\n                    _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                }\n            }, '#' + this.element.id + '_toolbar');\n            this.createLeftToolbarControls();\n            var zoomIn = document.querySelector('#' + this.element.id + '_zoomIn');\n            if (!isNullOrUndefined(zoomIn) && this.factor >= 8) {\n                zoomIn.classList.add('e-disabled');\n            }\n            else if (!isNullOrUndefined(zoomIn)) {\n                zoomIn.classList.remove('e-disabled');\n            }\n            var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n            if (!isNullOrUndefined(zoomOut) && this.factor === 1) {\n                zoomOut.classList.add('e-disabled');\n            }\n            else if (!isNullOrUndefined(zoomOut)) {\n                zoomOut.classList.remove('e-disabled');\n            }\n            var pan = document.querySelector('#' + this.element.id + '_pan');\n            if (!isNullOrUndefined(pan) && this.factor === 1) {\n                pan.style.display = 'none';\n            }\n            else if (!isNullOrUndefined(pan)) {\n                pan.style.display = 'block';\n            }\n            if (this.isToolbar() && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_3 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                toolbar_3.refreshOverflow();\n            }\n        }\n    };\n    ImageEditor.prototype.createLeftToolbarControls = function () {\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            var uploadDiv = document.getElementById(this.element.id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt e-btn top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.appendChild(this.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ImageEditor.prototype.renderAnnotationBtn = function () {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons e-annotation',\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (_this.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n            },\n            select: function (args) {\n                var isCropSelection = false;\n                var splitWords;\n                if (_this.activeObj.shape !== undefined) {\n                    splitWords = _this.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && _this.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                _this.currObjType.isCustomCrop = false;\n                if (isCropSelection || _this.togglePan) {\n                    _this.refreshActiveObj();\n                    _this.upperContext.clearRect(0, 0, _this.upperCanvas.width, _this.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                switch (args.item.id) {\n                    case 'pen':\n                        proxy.currentToolbar = 'pen';\n                        _this.freeHandDraw(true);\n                        break;\n                    case 'text':\n                        proxy.currentToolbar = 'text';\n                        _this.drawShapeText();\n                        break;\n                    default:\n                        proxy.currentToolbar = 'shapes';\n                        proxy.drawShape((args.item.id).toLowerCase());\n                        break;\n                }\n                _this.updateToolbarItems(_this.calcRatio());\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + this.element.id + '_annotationBtn');\n    };\n    ImageEditor.prototype.renderCropBtn = function () {\n        var _this = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (_this.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n            },\n            items: items, select: this.cropSelect.bind(this),\n            iconCss: 'e-icons e-select', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + this.element.id + '_cropBtn');\n    };\n    ImageEditor.prototype.renderTransformBtn = function () {\n        var _this = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (_this.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    var ht = args.element.parentElement.offsetHeight;\n                    args.element.parentElement.style.display = 'none';\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        ht + 'px';\n                    args.element.parentElement.style.display = 'block';\n                }\n            },\n            items: items, select: this.transformSelect.bind(this),\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + this.element.id + '_transformBtn');\n    };\n    ImageEditor.prototype.renderSaveBtn = function () {\n        var _this = this;\n        var imageEditorObj = getInstance(document.getElementById(this.element.id), ImageEditor_1);\n        var saveItems = [\n            { text: 'JPEG', id: 'jpeg' },\n            { text: 'PNG', id: 'png' },\n            { text: 'SVG', id: 'svg' }\n        ];\n        var ddbElem = document.getElementById(this.element.id + '_saveBtn');\n        if (ddbElem) {\n            // Initialize the DropDownButton component.\n            var saveDrpDownBtn = new DropDownButton({ items: saveItems, cssClass: 'e-caret-hide e-image-popup', iconCss: 'e-icons e-save',\n                select: function (args) {\n                    if (_this.togglePan) {\n                        _this.cancelPan();\n                    }\n                    imageEditorObj.export(args.item.text);\n                }\n            });\n            saveDrpDownBtn.appendTo('#' + this.element.id + '_saveBtn');\n        }\n    };\n    ImageEditor.prototype.cropSelect = function (args) {\n        var text = args.item.text;\n        this.select(text);\n        this.refreshToolbar('main', true, true);\n    };\n    ImageEditor.prototype.transformSelect = function (args) {\n        var text = args.item.id;\n        switch (text) {\n            case 'rotateleft':\n                this.rotate(-90);\n                break;\n            case 'rotateright':\n                this.rotate(90);\n                break;\n            case 'horizontalflip':\n                this.flip('Horizontal');\n                break;\n            case 'verticalflip':\n                this.flip('Vertical');\n                break;\n        }\n    };\n    ImageEditor.prototype.getShapesToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: this.element.id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: 'Stroke Width', align: 'Center',\n                type: 'Input', template: '<button id=\"' + this.element.id + '_borderWidthBtn\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n    };\n    ImageEditor.prototype.createShapeColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('fillColor') > -1) {\n            this.element.querySelector('.e-template.e-fill').appendChild(this.createElement('input', {\n                id: this.element.id + '_shape_fill'\n            }));\n            var fillColor = new ColorPicker({\n                modeSwitcher: false, noColor: true, value: '',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                change: function (args) {\n                    proxy.activeObj.strokeSettings.fillColor = args.currentValue.hex;\n                    proxy.strokeSettings.fillColor = proxy.activeObj.strokeSettings.fillColor;\n                    proxy.redrawShape(_this.activeObj);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                }\n            }, '#' + this.element.id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_fillColorBtn');\n            fillColor.inline = true;\n            this.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            this.element.querySelector('.e-template.e-stroke').appendChild(this.createElement('input', {\n                id: this.element.id + '_shape_stroke'\n            }));\n            var strokeColor = new ColorPicker({\n                modeSwitcher: false, noColor: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                change: function (args) {\n                    proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                    proxy.strokeSettings.strokeColor = proxy.activeObj.strokeSettings.strokeColor;\n                    if (!proxy.togglePen) {\n                        proxy.redrawShape(_this.activeObj);\n                    }\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + this.element.id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_borderColorBtn');\n            strokeColor.inline = true;\n            this.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ImageEditor.prototype.createShapeBtn = function (items) {\n        var _this = this;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        var ratio = this.calcRatio();\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(this.element.id + '_borderWidthBtn');\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.l10n.getConstant('Small');\n            spanElem_1.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_1);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_1 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    spanElem_1.textContent = args.item.text;\n                    _this.activeObj.strokeSettings.strokeWidth = parseInt(args.item.id, 10);\n                    if (_this.lowerCanvas.width > _this.lowerCanvas.height) {\n                        _this.activeObj.strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / _this.factor);\n                    }\n                    else {\n                        _this.activeObj.strokeSettings.strokeWidth *= ((ratio.height + ratio.width) / _this.factor);\n                    }\n                    _this.strokeSettings.strokeWidth = _this.activeObj.strokeSettings.strokeWidth;\n                    _this.redrawShape(_this.activeObj);\n                    if (Browser.isDevice) {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_4 = getComponent(_this.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_4.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_5 = getComponent(_this.element.id + '_toolbar', 'toolbar');\n                            toolbar_5.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_1.appendTo('#' + this.element.id + '_borderWidthBtn');\n        }\n    };\n    ImageEditor.prototype.getTextToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontStyle') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontStyle', cssClass: 'top-icon e-img-font-style',\n                tooltipText: this.l10n.getConstant('FontStyle'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontStyleBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: this.element.id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + this.element.id + '_fontColorBtn\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getFontFamilyItems = function () {\n        if (Browser.isDevice) {\n            return [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n        }\n        return [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n            { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n    };\n    ImageEditor.prototype.getFontSizeItems = function () {\n        if (Browser.isDevice) {\n            return [{ id: 'default', text: this.l10n.getConstant('ABC') }, { id: 'bold', text: this.l10n.getConstant('ABC') },\n                { id: 'italic', text: this.l10n.getConstant('ABC') }, { id: 'bolditalic', text: this.l10n.getConstant('ABC') }];\n        }\n        return [{ id: 'default', text: this.l10n.getConstant('Default') }, { id: 'bold', text: this.l10n.getConstant('Bold') },\n            { id: 'italic', text: this.l10n.getConstant('Italic') }, { id: 'bolditalic', text: this.l10n.getConstant('BoldItalic') }];\n    };\n    ImageEditor.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createTextColor(items);\n                _this.createTextBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n    };\n    ImageEditor.prototype.createTextColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('fontColor') > -1) {\n            this.element.querySelector('.e-template.e-text-font-color').appendChild(this.createElement('input', {\n                id: this.element.id + '_text_font'\n            }));\n            var fontColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                change: function (args) {\n                    if (proxy.textBox.style.display === 'none') {\n                        proxy.strokeSettings.strokeColor = proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                        if (!proxy.togglePen) {\n                            proxy.redrawShape(_this.activeObj);\n                        }\n                    }\n                    else if (proxy.textBox.style.display === 'block') {\n                        proxy.textBox.style.color = args.currentValue.hex;\n                    }\n                    else if (!proxy.togglePen) {\n                        proxy.redrawShape(_this.activeObj);\n                    }\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + this.element.id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_fontColorBtn');\n            fontColor.inline = true;\n            this.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ImageEditor.prototype.createTextBtn = function (items) {\n        var _this = this;\n        var ratio = this.calcRatio();\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(this.element.id + '_fontFamilyBtn');\n            var spanElem_2 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_2.innerHTML = 'ABC';\n                spanElem_2.setAttribute('style', 'font-family: arial');\n            }\n            else {\n                spanElem_2.innerHTML = 'Arial';\n            }\n            spanElem_2.className = 'e-text-font-family';\n            fontNameBtn.appendChild(spanElem_2);\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (_this.textBox.style.display === 'block') {\n                        fontFamily = _this.textBox.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = _this.activeObj.textSettings.fontFamily;\n                    }\n                    args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase()\n                        + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    spanElem_2.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_2.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    if (_this.textBox.style.display === 'block') {\n                        var temp = _this.activeObj.textSettings.fontFamily;\n                        _this.activeObj.textSettings.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.updateFontStyles();\n                        var width = _this.upperContext.measureText(_this.activeObj.keyHistory).width +\n                            _this.activeObj.textSettings.fontSize * 0.5;\n                        _this.textBox.style.width = Browser.isDevice ? width + 'px' : (width * ((ratio.width + ratio.height) / 2)) + 'px';\n                        _this.textBox.style.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.activeObj.textSettings.fontFamily = temp;\n                        _this.updateFontStyles();\n                    }\n                    else {\n                        _this.textSettings.fontFamily = _this.activeObj.textSettings.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.redrawText(ratio);\n                        _this.redrawShape(_this.activeObj);\n                    }\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + this.element.id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontStyle') > -1) {\n            var fontStyleBtnElem = document.getElementById(this.element.id + '_fontStyleBtn');\n            var span1Elem_1 = document.createElement('span');\n            if (Browser.isDevice) {\n                span1Elem_1.innerHTML = this.l10n.getConstant('ABC');\n            }\n            else {\n                span1Elem_1.innerHTML = this.l10n.getConstant('Default');\n            }\n            span1Elem_1.className = 'e-text-font-style';\n            fontStyleBtnElem.appendChild(span1Elem_1);\n            var fontStyleBtn_1 = new DropDownButton({ items: this.getFontSizeItems(),\n                cssClass: 'e-font-style',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    if (Browser.isDevice) {\n                        if (args.element.id === 'bold') {\n                            args.element.setAttribute('style', 'font-weight: bold');\n                        }\n                        else if (args.element.id === 'italic') {\n                            args.element.setAttribute('style', 'font-style: italic');\n                        }\n                        else if (args.element.id === 'bolditalic') {\n                            args.element.setAttribute('style', 'font-style: italic;font-weight: bold');\n                        }\n                    }\n                },\n                open: function (args) {\n                    var fontStyle = 'default';\n                    if (_this.textBox.style.display === 'block') {\n                        if (_this.textBox.style.fontWeight === 'bold') {\n                            fontStyle = 'bold';\n                        }\n                        if (_this.textBox.style.fontStyle === 'italic') {\n                            fontStyle = fontStyle.replace('default', '');\n                            fontStyle += 'italic';\n                        }\n                    }\n                    else {\n                        if (_this.activeObj.textSettings.bold) {\n                            fontStyle = 'bold';\n                        }\n                        if (_this.activeObj.textSettings.italic) {\n                            fontStyle = fontStyle.replace('default', '');\n                            fontStyle += 'italic';\n                        }\n                    }\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontStyleBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    args.element.querySelector('[id *= ' + '\"' + fontStyle + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    if (Browser.isDevice) {\n                        if (args.item.id === 'bold') {\n                            span1Elem_1.setAttribute('style', 'font-weight: bold');\n                        }\n                        else if (args.item.id === 'italic') {\n                            span1Elem_1.setAttribute('style', 'font-style: italic');\n                        }\n                        else if (args.item.id === 'bolditalic') {\n                            span1Elem_1.setAttribute('style', 'font-style: italic;font-weight: bold');\n                        }\n                        _this.applyFontStyle(args.item.id, ratio);\n                    }\n                    else {\n                        span1Elem_1.textContent = args.item.text;\n                        _this.applyFontStyle(args.item.id, ratio);\n                    }\n                }\n            });\n            fontStyleBtn_1.appendTo('#' + this.element.id + '_fontStyleBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(this.element.id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = this.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    if (_this.textBox.style.display === 'block') {\n                        var temp = _this.activeObj.textSettings.fontSize;\n                        _this.activeObj.textSettings.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10);\n                        var textStyle = '';\n                        if (_this.textBox.style.fontWeight === 'bold') {\n                            textStyle = 'bold ';\n                        }\n                        if (_this.textBox.style.fontStyle === 'italic') {\n                            textStyle = 'italic ';\n                        }\n                        if (_this.textBox.style.fontWeight === 'bold' && _this.textBox.style.fontStyle === 'italic') {\n                            textStyle = 'italic bold ';\n                        }\n                        _this.upperContext.font = textStyle + _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.textBox.style.fontFamily;\n                        var rows = _this.textBox.value.split('\\n');\n                        var text = _this.getMaxText(true);\n                        var width = _this.upperContext.measureText(text).width +\n                            _this.activeObj.textSettings.fontSize * 0.5;\n                        _this.textBox.style.width = width + 'px';\n                        _this.textBox.style.height = rows.length * (_this.activeObj.textSettings.fontSize + _this.activeObj.textSettings.fontSize * 0.25) + 'px';\n                        _this.activeObj.textSettings.fontSize = temp;\n                        _this.upperContext.font = _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.activeObj.textSettings.fontFamily;\n                        _this.textBox.style.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10) + 'px';\n                        if (_this.textBox.style.fontFamily === 'georgia') {\n                            _this.textBox.style.width = parseFloat(_this.textBox.style.width) + parseFloat(_this.textBox.style.fontSize) + 'px';\n                        }\n                    }\n                    else {\n                        _this.textSettings.fontSize = _this.activeObj.textSettings.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10);\n                        _this.upperContext.font = _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.activeObj.textSettings.fontFamily;\n                        var rows = _this.activeObj.keyHistory.split('\\n');\n                        var text = _this.getMaxText();\n                        var width = _this.upperContext.measureText(text).width +\n                            _this.activeObj.textSettings.fontSize * 0.5;\n                        var height = rows.length * (_this.activeObj.textSettings.fontSize + _this.activeObj.textSettings.fontSize * 0.25);\n                        _this.setTextSelection(width, height);\n                        _this.updateActiveObject(ratio, _this.activeObj.activePoint, _this.activeObj);\n                        _this.redrawShape(_this.activeObj);\n                        _this.redrawText(ratio);\n                    }\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + this.element.id + '_fontSizeBtn');\n        }\n    };\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.degree === 0 || this.degree % 180 === 0) {\n            fontSize = this.lowerCanvas.width / 20;\n        }\n        else {\n            fontSize = this.lowerCanvas.height / 20;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    ImageEditor.prototype.getTextAreaWidth = function (item) {\n        var tempBold = this.activeObj.textSettings.bold;\n        var tempItalic = this.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = true;\n                break;\n        }\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n            this.activeObj.textSettings.fontSize * 0.5;\n        this.activeObj.textSettings.bold = tempBold;\n        this.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    ImageEditor.prototype.applyFontStyle = function (item, ratio) {\n        switch (item) {\n            case 'default':\n                if (this.textBox.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textBox.style.width = Browser.isDevice ? width + 'px' : (width * ((ratio.width + ratio.height) / 2)) + 'px';\n                    this.textBox.style.fontWeight = 'normal';\n                    this.textBox.style.fontStyle = 'normal';\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = false;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = false;\n                    this.redrawText(ratio);\n                }\n                break;\n            case 'bold':\n                if (this.textBox.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textBox.style.width = Browser.isDevice ? width + 'px' : (width * ((ratio.width + ratio.height) / 2)) + 'px';\n                    this.textBox.style.fontWeight = 'bold';\n                    this.textBox.style.fontStyle = 'normal';\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = true;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = false;\n                    this.redrawText(ratio);\n                }\n                break;\n            case 'italic':\n                if (this.textBox.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textBox.style.width = Browser.isDevice ? width + 'px' : (width * ((ratio.width + ratio.height) / 2)) + 'px';\n                    this.textBox.style.fontWeight = 'normal';\n                    this.textBox.style.fontStyle = 'italic';\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = false;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = true;\n                    this.redrawText(ratio);\n                }\n                break;\n            case 'bolditalic':\n                if (this.textBox.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textBox.style.width = (width / ratio.width) + 'px';\n                    this.textBox.style.fontWeight = 'bold';\n                    this.textBox.style.fontStyle = 'italic';\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = true;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = true;\n                    this.redrawText(ratio);\n                }\n                break;\n        }\n    };\n    ImageEditor.prototype.initZoomToolbarItem = function () {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        this.defToolbarItems = leftItem.concat(zoomItem, rightItem);\n        new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderSaveBtn();\n                _this.trigger('toolbarCreated', { toolbarType: 'zoom' });\n            }\n        }, '#' + this.element.id + '_toolbar');\n        this.createLeftToolbarControls();\n        if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var toolbar_6 = getComponent(this.element.id + '_toolbar', 'toolbar');\n            toolbar_6.refreshOverflow();\n        }\n    };\n    ImageEditor.prototype.defToolbarClicked = function (args) {\n        var ratio = this.calcRatio();\n        var zoomIn;\n        var type = args.item.id.replace(this.element.id + '_', '').toLowerCase();\n        var imageEditorObj = getInstance(document.getElementById(this.element.id), ImageEditor_1);\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (!this.disabled) {\n            switch (type) {\n                case 'zoomin':\n                    if (this.togglePen) {\n                        this.currObjType.isZoomed = true;\n                        this.freeHandDraw(false);\n                    }\n                    imageEditorObj.zoom(.1);\n                    if (!this.togglePan) {\n                        this.callMainToolbar(false, true);\n                    }\n                    if (this.factor > 0.95 && this.factor < 1.05) {\n                        this.dragCanvas = this.togglePan = false;\n                        this.callMainToolbar(false, true);\n                    }\n                    if (isNullOrUndefined(this.activeObj.activePoint) || this.activeObj.activePoint.width === 0) {\n                        this.refreshToolbar('main');\n                    }\n                    else {\n                        this.refreshToolbar('main', true, true);\n                    }\n                    panBtn = this.element.querySelector('.e-img-pan .e-btn');\n                    if (!isNullOrUndefined(panBtn) && this.togglePan) {\n                        panBtn.classList.add('e-selected-btn');\n                    }\n                    else if (!isNullOrUndefined(panBtn)) {\n                        panBtn.classList.remove('e-selected-btn');\n                    }\n                    break;\n                case 'zoomout':\n                    if (this.togglePen) {\n                        this.currObjType.isZoomed = true;\n                        this.freeHandDraw(false);\n                    }\n                    imageEditorObj.zoom(-.1);\n                    if (!this.togglePan) {\n                        this.callMainToolbar(false, true);\n                    }\n                    if (this.factor > 0.95 && this.factor < 1.05) {\n                        this.dragCanvas = this.togglePan = false;\n                        this.callMainToolbar(false, true);\n                    }\n                    if (isNullOrUndefined(this.activeObj.activePoint) || this.activeObj.activePoint.width === 0) {\n                        this.refreshToolbar('main');\n                    }\n                    else {\n                        this.refreshToolbar('main', true, true);\n                    }\n                    panBtn = this.element.querySelector('.e-img-pan .e-btn');\n                    if (!isNullOrUndefined(panBtn) && this.togglePan) {\n                        panBtn.classList.add('e-selected-btn');\n                    }\n                    else if (!isNullOrUndefined(panBtn)) {\n                        panBtn.classList.remove('e-selected-btn');\n                    }\n                    break;\n                case 'pan':\n                    this.currObjType.isCustomCrop = false;\n                    if (isCropSelection) {\n                        this.currObjType.isCustomCrop = false;\n                        this.refreshActiveObj();\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (this.togglePan) {\n                        this.cancelPan();\n                    }\n                    else {\n                        panBtn = this.element.querySelector('.e-img-pan .e-btn');\n                        panBtn.classList.add('e-selected-btn');\n                        imageEditorObj.pan(true);\n                    }\n                    zoomIn = document.querySelector('#' + this.element.id + '_zoomIn');\n                    if (!isNullOrUndefined(zoomIn) && this.factor >= 8) {\n                        zoomIn.classList.add('e-disabled');\n                    }\n                    else if (!isNullOrUndefined(zoomIn)) {\n                        zoomIn.classList.remove('e-disabled');\n                    }\n                    break;\n                case 'cancel':\n                    if (this.textBox.style.display === 'block') {\n                        this.textBox.style.display = 'none';\n                        this.textBox.value = '';\n                        this.textBox.style.transform = '';\n                        this.activeObj.strokeSettings = this.tempStrokeSettings;\n                        this.activeObj.textSettings = this.tempTextSettings;\n                    }\n                    this.cancelItems();\n                    break;\n                case 'ok':\n                    if (isCropSelection) {\n                        this.crop();\n                    }\n                    else if (this.togglePen) {\n                        this.freeHandDraw(false);\n                    }\n                    else if (this.textBox.style.display === 'block') {\n                        this.redrawActObj();\n                    }\n                    else {\n                        this.applyActObj();\n                    }\n                    this.callMainToolbar(false);\n                    break;\n                case 'text':\n                    this.currObjType.isCustomCrop = false;\n                    imageEditorObj.drawShapeText();\n                    this.refreshToolbar(type);\n                    break;\n                case 'pen':\n                    this.currObjType.isCustomCrop = false;\n                    this.freeHandDraw(true);\n                    this.refreshToolbar(type);\n                    break;\n                case 'reset':\n                    imageEditorObj.reset();\n                    break;\n                case 'load':\n                    break;\n                case 'save':\n                    break;\n                case 'select':\n                    break;\n                case 'bold':\n                    this.currObjType.isCustomCrop = false;\n                    if (!this.isBoldbtn) {\n                        this.activeObj.textSettings.bold = true;\n                        this.isBoldbtn = true;\n                        this.redrawText(ratio);\n                    }\n                    else {\n                        this.activeObj.textSettings.bold = false;\n                        this.isBoldbtn = false;\n                        this.redrawText(ratio);\n                    }\n                    break;\n                case 'italic':\n                    this.currObjType.isCustomCrop = false;\n                    if (!this.isItalicbtn) {\n                        this.activeObj.textSettings.italic = true;\n                        if (this.activeObj.textSettings.bold) {\n                            this.upperContext.font = 'italic bold ' + this.activeObj.textSettings.fontSize + 'px' +\n                                ' ' + this.activeObj.textSettings.fontFamily;\n                        }\n                        else {\n                            this.upperContext.font = 'italic ' + this.activeObj.textSettings.fontSize + 'px' + ' ' +\n                                this.activeObj.textSettings.fontFamily;\n                        }\n                        var width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n                            this.activeObj.textSettings.fontSize * 0.5;\n                        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n                        this.setTextSelection(width, height);\n                        this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n                        this.redrawShape(this.activeObj);\n                        this.isItalicbtn = true;\n                    }\n                    else {\n                        this.activeObj.textSettings.italic = false;\n                        if (this.activeObj.textSettings.bold) {\n                            this.upperContext.font = 'bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n                        }\n                        else {\n                            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n                        }\n                        var width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n                            this.activeObj.textSettings.fontSize * 0.5;\n                        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n                        this.setTextSelection(width, height);\n                        this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n                        this.redrawShape(this.activeObj);\n                        this.isItalicbtn = false;\n                    }\n                    break;\n            }\n        }\n        this.trigger('toolbarItemClicked', args);\n    };\n    ImageEditor.prototype.cancelPan = function () {\n        this.applyActObj();\n        var panBtn = this.element.querySelector('.e-img-pan .e-btn');\n        panBtn.classList.remove('e-selected-btn');\n        this.pan(false);\n    };\n    ImageEditor.prototype.callMainToolbar = function (isApplyBtn, isZooming) {\n        if (this.factor === 1) {\n            this.refreshToolbar('main', isApplyBtn, false, isZooming);\n        }\n        else {\n            this.refreshToolbar('main', isApplyBtn, false, isZooming);\n        }\n    };\n    ImageEditor.prototype.cancelItems = function () {\n        var ratio = this.calcRatio();\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (this.togglePen) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.togglePen = false;\n            this.upperCanvas.style.cursor = 'default';\n            this.penDrawColl = [];\n            this.imageEditorPointsColl = [];\n        }\n        else if (this.activeObj.shape === 'text') {\n            this.activeObj.strokeSettings = this.tempStrokeSettings;\n            this.activeObj.textSettings = this.tempTextSettings;\n            if (this.activeObj.keyHistory === 'Enter Text' && this.activeObj.activePoint.startX === this.textStartPoints.x\n                && this.activeObj.activePoint.startY === this.textStartPoints.y) {\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.drawShapeText();\n            }\n            else {\n                this.redrawText(ratio);\n                this.redrawShape(this.activeObj);\n                if (!isCropSelection && this.activeObj.topLeftCircle !== undefined) {\n                    this.applyActObj();\n                }\n                this.clearSelection();\n            }\n            this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, bold: false, italic: false, underline: false };\n        }\n        else if (this.activeObj.shape === 'rectangle' || this.activeObj.shape === 'ellipse' || this.activeObj.shape === 'line') {\n            this.activeObj.strokeSettings = this.tempStrokeSettings;\n            this.redrawShape(this.activeObj);\n            this.applyActObj();\n        }\n        else {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n        this.upperCanvas.style.cursor = 'default';\n        this.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.callMainToolbar();\n    };\n    ImageEditor.prototype.gradient = function (a, b) {\n        return (b.y - a.y) / (b.x - a.x);\n    };\n    ImageEditor.prototype.applyPenDraw = function () {\n        if (this.togglePen && this.factor === 1 && !this.currObjType.isZoomed) {\n            this.apply();\n            this.penDrawColl = [];\n            this.imageEditorPointsColl = [];\n        }\n        else {\n            var tempCanvas = this.lowerCanvas.appendChild(this.createElement('canvas', {\n                id: this.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n            }));\n            var tempContext = tempCanvas.getContext('2d');\n            tempCanvas.width = this.lowerCanvas.width;\n            tempCanvas.height = this.lowerCanvas.height;\n            tempContext.drawImage(this.inMemoryCanvas, 0, 0);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            for (var i = 0; i < this.penDrawColl.length; i++) {\n                tempContext.lineWidth = 2 * this.penDrawColl[i].strokeWidth;\n                tempContext.strokeStyle = this.penDrawColl[i].strokeColor;\n                var nexP = void 0;\n                var preP = void 0;\n                var f = 0.3;\n                var t = 1;\n                tempContext.beginPath();\n                tempContext.moveTo(this.penDrawColl[i].points[0].x, this.penDrawColl[i].points[0].y);\n                var m = 0;\n                var dx1 = 0;\n                var dx2 = 0;\n                var dy1 = 0;\n                var dy2 = 0;\n                preP = this.penDrawColl[i].points[0];\n                for (var j = 1; j < this.penDrawColl[i].points.length; j++) {\n                    var curP = this.penDrawColl[i].points[j];\n                    nexP = this.penDrawColl[i].points[j + 1];\n                    if (nexP) {\n                        m = this.gradient(preP, nexP);\n                        dx2 = (nexP.x - curP.x) * -f;\n                        dy2 = dx2 * m * t;\n                    }\n                    else {\n                        dx2 = 0;\n                        dy2 = 0;\n                    }\n                    tempContext.bezierCurveTo(preP.x - dx1, preP.y - dy1, curP.x + dx2, curP.y + dy2, curP.x, curP.y);\n                    dx1 = dx2;\n                    dy1 = dy2;\n                    preP = curP;\n                    if (this.penDrawColl[i].points.length > 2) {\n                        this.penDrawColl[i].points.shift();\n                    }\n                    tempContext.stroke();\n                }\n            }\n            this.penDrawColl = [];\n            this.imageEditorPointsColl = [];\n            this.togglePen = false;\n            var imgData = tempContext.getImageData(0, 0, tempCanvas.width, tempCanvas.height);\n            var tempObj = void 0;\n            for (var index = 0; index < this.imgDataColl.length; index++) {\n                if (this.imgDataColl[index].operation !== 'freehanddraw') {\n                    tempObj = this.imgDataColl[index];\n                    break;\n                }\n            }\n            this.imgDataColl.splice(0, 1, { operation: 'freehanddraw', value: imgData });\n            this.imgDataColl.splice(1, 1, tempObj);\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.inMemoryCanvas.width = imgData.width;\n            this.inMemoryCanvas.height = imgData.height;\n            this.inMemoryContext.putImageData(imgData, 0, 0);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n            for (var j = 0; j < this.objColl.length; j++) {\n                this.apply(this.objColl[j].shape, this.objColl[j]);\n                this.refreshActiveObj();\n            }\n            this.currObjType.isZoomed = false;\n        }\n    };\n    ImageEditor.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming) {\n        var args = { toolbarType: type };\n        if (document.getElementById(this.element.id + '_toolbar') && this.defToolbarItems.length > 0) {\n            getComponent(document.getElementById(this.element.id + '_toolbar'), 'toolbar').destroy();\n        }\n        if (document.getElementById(this.element.id + '_bottomToolbar') && this.defToolbarItems.length > 0) {\n            if (document.getElementById(this.element.id + '_bottomToolbar').className.indexOf('e-control') > -1) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n            }\n        }\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initToolbarItem(false, true, true);\n                    }\n                    else {\n                        this.initToolbarItem(false, true);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    this.initToolbarItem(isApplyBtn, Browser.isDevice);\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                if (this.activeObj.shape === 'line') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth'];\n                }\n                this.trigger('toolbarUpdating', args);\n                this.initShapesToolbarItem(args.toolbarItems);\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontStyle', 'fontSize', 'fontColor'];\n                this.trigger('toolbarUpdating', args);\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth'];\n                this.trigger('toolbarUpdating', args);\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'pan':\n                this.initZoomToolbarItem();\n                break;\n        }\n    };\n    ImageEditor.prototype.getPenToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + this.element.id + '_penStrokeWidth\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n    };\n    ImageEditor.prototype.createPenColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('strokeColor') > -1) {\n            this.element.querySelector('.e-template.e-pen-stroke-color').appendChild(this.createElement('input', {\n                id: this.element.id + '_pen_stroke'\n            }));\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                    if (!proxy.togglePen) {\n                        proxy.redrawShape(_this.activeObj);\n                    }\n                    strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + this.element.id + '_pen_stroke');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_penColorBtn');\n            penColor.inline = true;\n            this.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ImageEditor.prototype.createPenBtn = function (items) {\n        var _this = this;\n        var ratio = this.calcRatio();\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(this.element.id + '_penStrokeWidth');\n            var spanElem_3 = document.createElement('span');\n            spanElem_3.innerHTML = this.l10n.getConstant('Small');\n            spanElem_3.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    spanElem_3.textContent = args.item.text;\n                    _this.setPenStroke(args.item.id, ratio);\n                    if (Browser.isDevice) {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_7 = getComponent(_this.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_7.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(_this.element.id + '_toolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + this.element.id + '_penStrokeWidth');\n        }\n    };\n    ImageEditor.prototype.setPenStroke = function (args, ratio) {\n        switch (parseInt(args, 10)) {\n            case 1:\n                this.penStrokeWidth = (ratio.width + ratio.height) * 0.4;\n                break;\n            case 2:\n                this.penStrokeWidth = (ratio.width + ratio.height) * 0.8;\n                break;\n            case 3:\n                this.penStrokeWidth = (ratio.width + ratio.height) * 1.2;\n                break;\n            case 4:\n                this.penStrokeWidth = (ratio.width + ratio.height) * 1.6;\n                break;\n            case 5:\n                this.penStrokeWidth = (ratio.width + ratio.height) * 2;\n                break;\n        }\n    };\n    ImageEditor.prototype.updateCanvas = function () {\n        this.lastX = this.baseImg.width / 2;\n        this.lastY = this.baseImg.height / 2;\n        var wrapperWidth;\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        if (this.isScreenOriented) {\n            wrapperWidth = parseFloat(canvasWrapper.style.width);\n        }\n        else {\n            wrapperWidth = this.element.clientWidth;\n        }\n        var maxDimension = this.calcMaxDimension(this.baseImg.width, this.baseImg.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerCanvas.width = this.upperCanvas.width = this.inMemoryCanvas.width = this.baseImg.width;\n        this.lowerCanvas.height = this.upperCanvas.height = this.inMemoryCanvas.height = this.baseImg.height;\n        this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n        this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n        this.lowerCanvas.style.left = this.upperCanvas.style.left = (wrapperWidth - maxDimension.width) / 2 + 1 + 'px';\n        if (canvasWrapper) {\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = (parseFloat(canvasWrapper.style.height) - maxDimension.height - 1) / 2 + 'px';\n        }\n        this.lowerContext.drawImage(this.baseImg, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.updateInMemoryCanvas('updateCanvas');\n        for (var i = 0, len = this.objColl.length; i < len; i++) {\n            this.apply(this.objColl[i].shape, this.objColl[i]);\n        }\n        if (this.isUndoRedo) {\n            if (this.flipState !== '') {\n                this.flip(this.flipState);\n            }\n        }\n        if (this.disabled) {\n            this.element.setAttribute('class', 'e-disabled');\n        }\n        this.trigger('fileOpened');\n    };\n    ImageEditor.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        proxy.baseImg.src = proxy.baseImgSrc = src;\n        this.baseImg.onload = function () {\n            _this.lowerContext.drawImage(_this.baseImg, 0, 0, _this.lowerCanvas.width, _this.lowerCanvas.height);\n            if (_this.togglePen) {\n                // eslint-disable-next-line @typescript-eslint/tslint/config\n                _this.lowerCanvas.toBlob(function (blob) {\n                    showSpinner(proxy.element);\n                    proxy.baseImg.src = URL.createObjectURL(blob);\n                    proxy.togglePen = false;\n                }, 'image/png');\n                _this.inMemoryContext.clearRect(0, 0, _this.inMemoryCanvas.width, _this.inMemoryCanvas.height);\n                var imgData = _this.lowerContext.getImageData(0, 0, _this.lowerCanvas.width, _this.lowerCanvas.height);\n                _this.inMemoryContext.putImageData(imgData, 0, 0);\n                var temp = _this.imgDataColl[0];\n                _this.imgDataColl.splice(0, 1, { operation: 'freehanddraw', value: imgData });\n                _this.imgDataColl.splice(1, 1, temp);\n            }\n            else {\n                hideSpinner(_this.element);\n                _this.element.style.opacity = '1';\n                _this.updateCanvas();\n                _this.isUndoRedo = false;\n            }\n            if (Browser.isDevice) {\n                if (_this.isToolbar() && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                }\n                if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                }\n                _this.initToolbarItem(false, Browser.isDevice);\n                _this.createBottomToolbar();\n            }\n            else {\n                if (_this.isToolbar() && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                }\n                _this.initToolbarItem(false, false);\n            }\n        };\n    };\n    ImageEditor.prototype.refreshActiveObj = function () {\n        this.activeObj = {};\n        this.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        this.activeObj.flipObjColl = [];\n        this.activeObj.strokeSettings = this.strokeSettings;\n        this.activeObj.textSettings = this.textSettings;\n    };\n    ImageEditor.prototype.redrawText = function (ratio) {\n        if (this.activeObj.textSettings.bold) {\n            this.upperContext.font = 'bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (this.activeObj.textSettings.italic) {\n            this.upperContext.font = 'bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n            this.upperContext.font = 'italic bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var text = this.textBox.style.display === 'block' ? this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + this.activeObj.textSettings.fontSize * 0.5;\n        var height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25);\n        this.setTextSelection(width, height);\n        this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n        this.redrawShape(this.activeObj);\n    };\n    ImageEditor.prototype.setTextSelection = function (width, height) {\n        var degree = this.degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0; i < this.activeObj.flipObjColl.length; i++) {\n            if (degree === 0) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.endX - width,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                        endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n                }\n            }\n            else if (degree === 90) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - width,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n                else {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n            }\n            else if (degree === 180) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + width),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + height;\n                    this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                        startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                        startY: this.activeObj.activePoint.startY };\n                }\n                else {\n                    this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                        startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                        startY: this.activeObj.activePoint.endY - (height ? height : 0) };\n                }\n            }\n            else if (degree === 270) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + height),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                        endX: this.activeObj.activePoint.endX,\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else {\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                        endX: this.activeObj.activePoint.endX,\n                        endY: this.activeObj.activePoint.endY };\n                }\n            }\n        }\n        if (this.activeObj.flipObjColl.length === 0) {\n            if (degree === 0) {\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                    endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                    endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n            }\n            else if (degree === 90) {\n                this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                    endX: (this.activeObj.activePoint.endX),\n                    endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n            }\n            else if (degree === 180) {\n                this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                    startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                    startY: this.activeObj.activePoint.endY - (height ? height : 0) };\n            }\n            else if (degree === 270) {\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                    startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                    endX: this.activeObj.activePoint.endX,\n                    endY: this.activeObj.activePoint.endY };\n            }\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        if (this.degree === 360 || this.degree === -360) {\n            this.degree = 0;\n        }\n    };\n    ImageEditor.prototype.updateUndoRedoColl = function (operation, value, previousObj, currentObj) {\n        this.undoRedoColl.push({ operation: operation, value: value, previousObj: previousObj, currentObj: currentObj });\n    };\n    ImageEditor.prototype.fileSelect = function (inputElement, args) {\n        showSpinner(this.element);\n        this.element.style.opacity = '0.5';\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = args.target.files[0];\n        if (this.imgDataColl.length > 0) {\n            this.imgDataColl = [];\n            this.reset();\n        }\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var URL = window.URL;\n        var url = URL.createObjectURL(filesData);\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    ImageEditor.prototype.findTextPoint = function (e) {\n        if (this.activeObj.shape === 'text') {\n            this.textBox.style.transformOrigin = '0 0';\n            var degree = void 0;\n            var scale = '';\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (this.activeObj.flipObjColl.length > 0) {\n                // need to add scale value according to length.\n                for (var i = 0; i < this.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        this.textBox.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        this.textBox.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                this.textBox.style.transform = 'rotate(' + degree + 'deg)';\n            }\n            this.findTextTarget(e);\n        }\n    };\n    ImageEditor.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        switch (text) {\n            case '1':\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case '2':\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case '3':\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case '4':\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case '5':\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ImageEditor.prototype.updateToolbarItems = function (ratio) {\n        var selFillElem = this.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n        var selStrokeElem = this.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n        var selTextStrokeElem = this.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n        var selPenStrokeElem = this.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n        var strokeWidthElem = this.element.querySelector('.e-shape-stroke-width');\n        var fontFamilyElem = this.element.querySelector('.e-text-font-family');\n        var fontSizeElem = this.element.querySelector('.e-text-font-size');\n        var fontStyleElem = this.element.querySelector('.e-text-font-style');\n        if (selFillElem) {\n            if (this.activeObj.strokeSettings.fillColor === '') {\n                selFillElem.classList.add('e-nocolor-item');\n            }\n            else {\n                selFillElem.classList.remove('e-nocolor-item');\n                selFillElem.style.background = this.activeObj.strokeSettings.fillColor;\n            }\n            getComponent(this.element.id + '_shape_fill', 'colorpicker').value\n                = this.activeObj.strokeSettings.fillColor + 'ff';\n        }\n        if (selStrokeElem) {\n            selStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_shape_stroke', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selTextStrokeElem) {\n            selTextStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_text_font', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selPenStrokeElem) {\n            selPenStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_pen_stroke', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (fontFamilyElem) {\n            if (Browser.isDevice) {\n                fontFamilyElem.setAttribute('style', 'font-family:' + this.activeObj.textSettings.fontFamily.toLowerCase());\n            }\n            else {\n                fontFamilyElem.textContent = this.activeObj.textSettings.fontFamily;\n            }\n        }\n        if (fontSizeElem) {\n            for (var i = 0; i < this.fontSizeColl.length; i++) {\n                if (parseInt(this.fontSizeColl[i].text, 10) >= this.activeObj.textSettings.fontSize) {\n                    fontSizeElem.textContent = (i + 1).toString();\n                    break;\n                }\n            }\n        }\n        if (fontStyleElem) {\n            if (Browser.isDevice) {\n                if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n                    fontStyleElem.setAttribute('style', '');\n                }\n                else if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                    fontStyleElem.setAttribute('style', 'font-style: italic;font-weight: bold');\n                }\n                else if (this.activeObj.textSettings.bold) {\n                    fontStyleElem.setAttribute('style', 'font-weight: bold');\n                }\n                else {\n                    fontStyleElem.setAttribute('style', 'font-style: italic');\n                }\n            }\n            else {\n                if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n                    fontStyleElem.textContent = 'Default';\n                }\n                else if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                    fontStyleElem.textContent = 'Bold Italic';\n                }\n                else if (this.activeObj.textSettings.bold) {\n                    fontStyleElem.textContent = 'Bold';\n                }\n                else {\n                    fontStyleElem.textContent = 'Italic';\n                }\n            }\n        }\n        if (strokeWidthElem) {\n            var strokeWidth = Math.round((this.activeObj.strokeSettings.strokeWidth /\n                (ratio.width + ratio.height))).toString();\n            strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n        }\n    };\n    ImageEditor.prototype.setTimer = function (e) {\n        if (!this.isTimer && this.timer > 10) {\n            this.findTextPoint(e);\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            }\n        }\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n        this.mouseDownEventHandler(e);\n        EventHandler.add(this.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this); // Unbind mousedown to prevent double triggers from touch devices\n        EventHandler.add(this.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this); // Unbind mousedown to prevent double triggers from touch devices\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        if (e.type === 'touchstart' && e.currentTarget === this.lowerCanvas && this.imgDataColl.length === 0) {\n            return;\n        }\n        var ratio = this.calcRatio();\n        if (this.dragCanvas) {\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            e.preventDefault();\n            var x = void 0;\n            var y = void 0;\n            if (e.type === 'mousedown') {\n                x = e.clientX;\n                y = e.clientY;\n            }\n            else {\n                this.touchEndPoint.x = x = e.touches[0].clientX;\n                this.touchEndPoint.y = y = e.touches[0].clientY;\n            }\n            this.redrawActObj(x, y);\n            if (this.upperCanvas.style.cursor === 'crosshair' || (Browser.isDevice && this.togglePen)) {\n                if (this.togglePen) {\n                    this.canvasRatio = this.calcRatio();\n                    if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                        this.activeObj.strokeSettings = this.strokeSettings;\n                    }\n                    if (isNullOrUndefined(this.penStrokeWidth)) {\n                        this.penStrokeWidth = (ratio.width + ratio.height) * 0.8;\n                    }\n                    if (this.activeObj.strokeSettings.strokeWidth === (ratio.width + ratio.height) * 0.4 &&\n                        this.strokeSettings.strokeWidth === (ratio.width + ratio.height) * 0.4) {\n                        this.activeObj.strokeSettings.strokeWidth = this.strokeSettings.strokeWidth =\n                            2 * ((ratio.width + ratio.height) / this.factor);\n                    }\n                    this.minStrokeWidth = this.maxStrokeWidth = this.penStrokeWidth;\n                    this.velocity = 0.7;\n                    this.upperContext.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n                    this.upperContext.fillStyle = this.activeObj.strokeSettings.strokeColor;\n                    this.mouseDownHandler(e, this.upperCanvas, this.pannStart, this.factor); // To call signature base\n                }\n                else {\n                    this.refreshActiveObj();\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                }\n                this.currObjType.isActiveObj = false;\n                this.dragElement = '';\n                this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n            }\n            if ((this.upperCanvas.style.cursor !== 'crosshair' && e.type.toLowerCase() === 'touchstart') ||\n                (this.currObjType.isActiveObj && this.upperCanvas.style.cursor !== 'default' && !this.togglePen)) {\n                this.findTarget(x, y, e.type);\n            }\n            else if ((this.currObjType.shape === '' || this.currObjType.isCustomCrop) && !this.togglePen && this.upperCanvas.style.cursor !== 'default') {\n                this.setActivePoint(x, y);\n            }\n            if (!isNullOrUndefined(this.activeObj)) {\n                var isCropSelection = false;\n                var splitWords = void 0;\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && (this.currObjType.isCustomCrop || this.togglePen)) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                if ((this.activeObj.shape === 'rectangle') || (this.activeObj.shape === 'ellipse')\n                    || (this.activeObj.shape === 'line')) {\n                    this.refreshToolbar('shapes');\n                }\n                else if (this.activeObj.shape === 'text') {\n                    this.refreshToolbar('text');\n                }\n                else if (!isCropSelection) {\n                    this.callMainToolbar();\n                }\n                this.updateToolbarItems(ratio);\n            }\n        }\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        e.preventDefault();\n        if (this.textBox.style.display === 'none') {\n            this.isTimer = true;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        this.canvasMouseMoveHandler(e);\n        if (this.currObjType.isActiveObj && (this.activeObj.activePoint !== undefined || this.objColl.length > 0) &&\n            !this.dragCanvas || this.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                this.findTarget(x, y, e.type);\n            }\n        }\n        if (this.currObjType.isDragging) {\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            var initialDraw = this.updateActivePoint(x, y);\n            this.drawObject('duplicate', null, initialDraw);\n        }\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mouseup') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            x = this.touchEndPoint.x;\n            y = this.touchEndPoint.y;\n        }\n        if (e.type === 'touchend') {\n            if (this.textBox.style.display === 'none') {\n                this.isTimer = false;\n                this.timer = 0;\n            }\n        }\n        var bbox = this.upperCanvas.getBoundingClientRect();\n        var ratio = this.calcRatio();\n        if (this.factor === 1) {\n            x = (x - bbox.left) * ratio.width;\n            y = (y - bbox.top) * ratio.height;\n        }\n        else {\n            x = (x - bbox.left) + ((this.pannStart.startX) / ratio.width * this.factor);\n            y = (y - bbox.top) + ((this.pannStart.startY) / ratio.height * this.factor);\n        }\n        if (e.currentTarget === this.upperCanvas) {\n            this.currObjType.shape = this.currObjType.shape.toLowerCase();\n            if (!this.togglePen && !this.dragCanvas) {\n                this.applyCurrActObj(x, y);\n            }\n        }\n        if (this.togglePen && e.currentTarget === this.upperCanvas) {\n            this.penDrawColl.push({ strokeWidth: this.penStrokeWidth, strokeColor: this.activeObj.strokeSettings.strokeColor, points: this.imageEditorPointsColl });\n            this.imageEditorPointsColl = [];\n        }\n        else {\n            this.currObjType.shape = '';\n        }\n        this.dragElement = '';\n        this.currObjType.isInitialLine = this.currObjType.isDragging = false;\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        var _this = this;\n        var shapeChangingArgs = {};\n        var beforeSave = { fileName: 'ImageEditor', fileType: 'Png', cancel: false };\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                this.trigger('beforeSave', beforeSave, function (observableSaveArgs) {\n                    if (!beforeSave.cancel) {\n                        _this.export(observableSaveArgs.fileType, observableSaveArgs.fileName);\n                    }\n                });\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                break;\n            case 'Delete':\n                shapeChangingArgs = { action: 'delete', previousShapeSettings: this.activeObj, currentShapeSettings: null };\n                this.keyHistory = '';\n                this.clearSelection();\n                this.trigger('shapeChanging', shapeChangingArgs);\n                this.refreshToolbar('main');\n                break;\n            case 'Escape':\n                if (this.togglePan) {\n                    this.refreshToolbar(this.currentToolbar);\n                    this.pan(false);\n                }\n                else {\n                    this.cancelItems();\n                }\n                break;\n            case 'Enter':\n                this.crop();\n                break;\n            default:\n                if (Browser.isDevice && this.textBox.style.display === 'block') {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        setTimeout(this.textKeyDown.bind(this), 1, e);\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        e.preventDefault();\n        var ratio = this.calcRatio();\n        if (e.type === 'mousedown') {\n            this.lastX = e.offsetX || (e.pageX - this.lowerCanvas.offsetLeft);\n            this.lastY = e.offsetY || (e.pageY - this.lowerCanvas.offsetTop);\n        }\n        else {\n            this.lastX = e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft);\n            this.lastY = e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop);\n        }\n        this.lastX *= ratio.width;\n        this.lastY *= ratio.height;\n        if (this.dragCanvas || this.factor !== 1) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            this.dragStart = this.lowerContext.transformedPoint(this.lastX, this.lastY);\n            this.dragged = false;\n        }\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        if (this.dragCanvas && this.factor > 1) {\n            this.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = this.togglePan = false;\n            this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'default';\n        }\n        var ratio = this.calcRatio();\n        if (e.type === 'mousemove') {\n            this.lastX = e.offsetX || (e.pageX - this.lowerCanvas.offsetLeft);\n            this.lastY = e.offsetY || (e.pageY - this.lowerCanvas.offsetTop);\n        }\n        else {\n            this.lastX = e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft);\n            this.lastY = e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop);\n        }\n        this.lastX *= ratio.width;\n        this.lastY *= ratio.height;\n        this.dragged = true;\n        if (this.dragStart && this.dragCanvas) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var pt = this.lowerContext.transformedPoint(this.lastX, this.lastY);\n            var transitionArgs = { startPoint: { x: this.dragStart.x, y: this.dragStart.y },\n                endPoint: { x: pt.x, y: pt.y } };\n            this.trigger('panning', transitionArgs);\n            var xDiff = pt.x - this.dragStart.x;\n            var yDiff = pt.y - this.dragStart.y;\n            var xxDiff = xDiff;\n            var yyDiff = yDiff;\n            this.lowerContext.translate(xDiff, yDiff);\n            this.upperContext.translate(xDiff, yDiff);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var pt1 = this.lowerContext.transformedPoint(0, 0);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var pt2 = this.lowerContext.transformedPoint(this.lowerCanvas.width, this.lowerCanvas.height);\n            if (xDiff >= 0) {\n                if (pt1.x < 1) {\n                    xDiff = 0;\n                }\n            }\n            else {\n                if (pt2.x > this.lowerCanvas.width) {\n                    xDiff = 0;\n                }\n            }\n            if (yDiff >= 0) {\n                if (pt1.y < 1) {\n                    yDiff = 0;\n                }\n            }\n            else {\n                if (pt2.y > this.lowerCanvas.height) {\n                    yDiff = 0;\n                }\n            }\n            this.lowerContext.translate(-xxDiff, -yyDiff);\n            this.upperContext.translate(-xxDiff, -yyDiff);\n            this.lowerContext.translate(xDiff, yDiff);\n            this.upperContext.translate(xDiff, yDiff);\n            this.redraw();\n        }\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        e.preventDefault();\n        this.dragStart = null;\n        this.currObjType.isDragging = false;\n    };\n    ImageEditor.prototype.textKeyDown = function (e) {\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        this.textBox.setAttribute('rows', this.textRow.toString());\n        this.textBox.style.height = 'auto';\n        this.textBox.style.height = this.textBox.scrollHeight + 'px';\n        this.setTextBoxWidth(e);\n        if (Browser.isDevice) {\n            this.textBox.style.width = parseFloat(this.textBox.style.width) + this.textBox.style.fontSize + 'px';\n        }\n        var rows = this.textBox.value.split('\\n');\n        this.textRow = rows.length;\n        this.textBox.setAttribute('rows', this.textRow.toString());\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        this.applyActObj();\n        this.refreshActiveObj();\n        if (this.imgDataColl.length > 0) {\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n        }\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.lowerCanvas.width = this.upperCanvas.width = this.element.offsetWidth;\n        this.lowerCanvas.height = this.upperCanvas.height = this.element.offsetHeight;\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        if (!isNullOrUndefined(canvasWrapper)) {\n            canvasWrapper.style.width = this.element.offsetWidth + 'px';\n            canvasWrapper.style.height = this.element.offsetHeight + 'px';\n            if (Browser.isDevice) {\n                canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * this.toolbarHeight)) - 3 + 'px';\n            }\n            else {\n                canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - this.toolbarHeight) - 3 + 'px';\n            }\n        }\n        this.redrawImg();\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        this.lowerCanvas.toBlob(function (blob) {\n            proxy.baseImg.src = URL.createObjectURL(blob);\n        }, 'image/png');\n        if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var toolbar_9 = getComponent(proxy.element.id + '_toolbar', 'toolbar');\n            toolbar_9.refreshOverflow();\n        }\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            this.isScreenOriented = true;\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.redrawImg = function () {\n        var wrapperWidth;\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        if (this.isScreenOriented) {\n            wrapperWidth = parseFloat(canvasWrapper.style.width);\n        }\n        else {\n            wrapperWidth = this.element.clientWidth;\n        }\n        var maxDimension = this.calcMaxDimension(this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n        this.lowerCanvas.width = this.upperCanvas.width = this.inMemoryCanvas.width;\n        this.lowerCanvas.height = this.upperCanvas.height = this.inMemoryCanvas.height;\n        this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n        this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n        this.lowerCanvas.style.left = this.upperCanvas.style.left = (wrapperWidth - maxDimension.width) / 2 + 1 + 'px';\n        this.lowerCanvas.style.top = this.upperCanvas.style.top = (this.element.offsetHeight - this.toolbarHeight - maxDimension.height) / 2 + 1 + 'px';\n        this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ImageEditor.prototype.updateContext = function (ctx) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var xform = new DOMMatrix();\n        ctx.getTransform = function () {\n            return xform;\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var savedTransforms = [];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var save = ctx.save;\n        ctx.save = function () {\n            savedTransforms.push(xform.translate(0, 0));\n            return save.call(ctx);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var restore = ctx.restore;\n        ctx.restore = function () {\n            xform = savedTransforms.pop();\n            return restore.call(ctx);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var scale = ctx.scale;\n        ctx.scale = function (sx, sy) {\n            xform = _this.scaleNonUniform(xform, sx, sy);\n            proxy.factor = xform.a;\n            return scale.call(ctx, sx, sy);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var rotate = ctx.rotate;\n        ctx.rotate = function (radians) {\n            xform = xform.rotate(radians * 180 / Math.PI);\n            return rotate.call(ctx, radians);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var translate = ctx.translate;\n        ctx.translate = function (dx, dy) {\n            xform = xform.translate(dx, dy);\n            return translate.call(ctx, dx, dy);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var transform = ctx.transform;\n        ctx.transform = function (a, b, c, d, e, f) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var m2 = new DOMMatrix();\n            m2.a = a;\n            m2.b = b;\n            m2.c = c;\n            m2.d = d;\n            m2.e = e;\n            m2.f = f;\n            xform = xform.multiply(m2);\n            return transform.call(ctx, a, b, c, d, e, f);\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var setTransform = ctx.setTransform;\n        ctx.setTransform = function (a, b, c, d, e, f) {\n            xform.a = a;\n            xform.b = b;\n            xform.c = c;\n            xform.d = d;\n            xform.e = e;\n            xform.f = f;\n            return setTransform.call(ctx, a, b, c, d, e, f);\n        };\n        var pt = new DOMPoint();\n        ctx.transformedPoint = function (x, y) {\n            pt.x = x;\n            pt.y = y;\n            return pt.matrixTransform(xform.inverse());\n        };\n    };\n    ImageEditor.prototype.scaleNonUniform = function (xform, sx, sy) {\n        xform.m11 *= sx;\n        xform.m12 *= sx;\n        xform.m13 *= sx;\n        xform.m14 *= sx;\n        xform.m21 *= sy;\n        xform.m22 *= sy;\n        xform.m23 *= sy;\n        xform.m24 *= sy;\n        return xform;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ImageEditor.prototype.zoomImg = function (clicks) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var pt = this.lowerContext.transformedPoint(this.lastX, this.lastY);\n        var scaleFactor = 1.1;\n        var transitionArgs = { zoomPoint: { x: pt.x, y: pt.y }, zoomLevel: clicks };\n        this.trigger('zooming', transitionArgs);\n        this.lowerContext.translate(pt.x, pt.y);\n        this.upperContext.translate(pt.x, pt.y);\n        var factor = Math.pow(scaleFactor, clicks);\n        this.factor += (factor - 1);\n        this.lowerContext.scale(factor, factor);\n        this.upperContext.scale(factor, factor);\n        this.lowerContext.translate(-pt.x, -pt.y);\n        this.upperContext.translate(-pt.x, -pt.y);\n        var ratio = this.calcRatio();\n        if (!isNullOrUndefined(this.strokeSettings.strokeWidth)) {\n            this.strokeSettings.strokeWidth = 2 * (ratio.width + ratio.height) / this.factor;\n        }\n        if (this.factor > 0.99 && this.factor < 1.01) {\n            this.factor = 1;\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n            for (var j = 0; j < this.objColl.length; j++) {\n                this.apply(this.objColl[j].shape, this.objColl[j]);\n                this.refreshActiveObj();\n            }\n        }\n        else {\n            if (this.factor > 1) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var pt1 = this.lowerContext.transformedPoint(0, 0);\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var pt2 = this.lowerContext.transformedPoint(this.lowerCanvas.width, this.lowerCanvas.height);\n                var xDiff = pt.x;\n                var yDiff = pt.y;\n                if (pt1.x < 1) {\n                    xDiff = -xDiff;\n                }\n                else if (pt2.x > this.lowerCanvas.width) {\n                    xDiff = pt2.x - this.lowerCanvas.width;\n                }\n                if (pt1.y < 1) {\n                    yDiff = -yDiff;\n                }\n                else if (pt2.y > this.lowerCanvas.height) {\n                    yDiff = pt2.y - this.lowerCanvas.height;\n                }\n                if (xDiff !== pt.x || yDiff !== pt.y) {\n                    if (xDiff === pt.x) {\n                        xDiff = 0;\n                    }\n                    if (yDiff === pt.y) {\n                        yDiff = 0;\n                    }\n                    this.lowerContext.translate(xDiff, yDiff);\n                    this.upperContext.translate(xDiff, yDiff);\n                }\n            }\n            this.redraw();\n        }\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ImageEditor.prototype.handleScroll = function (e) {\n        var delta = e.wheelDelta ? e.wheelDelta / 40 : e.detail ? -e.detail : 0;\n        if (delta) {\n            this.zoom(delta);\n        }\n        return e.preventDefault() && false;\n    };\n    ImageEditor.prototype.redraw = function () {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var p1 = this.lowerContext.transformedPoint(0, 0);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var p2 = this.lowerContext.transformedPoint(this.lowerCanvas.width, this.lowerCanvas.height);\n        this.pannStart.startX = p1.x;\n        this.pannStart.startY = p1.y;\n        this.pannEnd.startX = this.lowerCanvas.width - p2.x;\n        this.pannEnd.startY = this.lowerCanvas.height - p2.y;\n        this.lowerContext.clearRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);\n        this.upperContext.clearRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);\n        this.lowerContext.save();\n        this.upperContext.save();\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.restore();\n        this.upperContext.restore();\n        this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n        for (var j = 0; j < this.objColl.length; j++) {\n            this.apply(this.objColl[j].shape, this.objColl[j]);\n            this.refreshActiveObj();\n        }\n    };\n    ImageEditor.prototype.applyCurrActObj = function (x, y) {\n        var isInside = false;\n        var ratio = this.calcRatio();\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (this.factor !== 1) {\n            actObj = this.setCursorForZoomState(actObj, ratio, true);\n        }\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        if ((x >= Math.floor(actObj.activePoint.startX) && x <= Math.ceil(actObj.activePoint.endX) &&\n            y >= Math.floor(actObj.activePoint.startY) && y <= Math.ceil(actObj.activePoint.endY)) ||\n            (actObj.shape === 'text')) {\n            isInside = true;\n        }\n        if (!isInside) {\n            if (this.activeObj.horTopLine !== undefined && this.activeObj.horTopLine.startX !== 0 && this.activeObj.horTopLine.endX !== 0\n                && !this.currObjType.isCustomCrop && this.currObjType.shape !== '') {\n                this.objColl.push(extend({}, this.activeObj, {}, true));\n            }\n            if (this.activeObj.shape === 'text' || (this.currObjType.shape === 'ellipse' || this.currObjType.shape === 'rectangle' ||\n                this.currObjType.shape === 'line')) {\n                for (var j = 0; j < this.objColl.length; j++) {\n                    this.apply(this.objColl[j].shape, this.objColl[j]);\n                }\n                this.apply('shape');\n            }\n        }\n    };\n    ImageEditor.prototype.updateTextFromTextArea = function (ratio) {\n        this.activeObj.keyHistory = this.textBox.value;\n        this.textBox.style.display = 'none';\n        this.textBox.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n            this.activeObj.textSettings.fontSize * 0.5;\n        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n        var rows = this.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            var widthColl = [];\n            for (var i = 0; i < rows.length; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width +\n                    this.activeObj.textSettings.fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        this.setTextSelection(width, height);\n        this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n    };\n    ImageEditor.prototype.redrawActObj = function (x, y) {\n        var ratio = this.calcRatio();\n        var splitWords;\n        var bbox = this.upperCanvas.getBoundingClientRect();\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (this.activeObj.horTopLine !== undefined && (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n            if (this.textBox.style.display === 'block') {\n                this.activeObj.textSettings.fontFamily = this.textBox.style.fontFamily;\n                this.activeObj.strokeSettings.strokeColor = this.textBox.style.color;\n                if (this.textBox.style.fontWeight === 'bold') {\n                    this.activeObj.textSettings.bold = true;\n                }\n                else {\n                    this.activeObj.textSettings.bold = false;\n                }\n                if (this.textBox.style.fontStyle === 'italic') {\n                    this.activeObj.textSettings.italic = true;\n                }\n                else {\n                    this.activeObj.textSettings.italic = false;\n                }\n                this.activeObj.textSettings.fontSize = (parseFloat(this.textBox.style.fontSize) * ((ratio.width + ratio.height) / 2)) / this.factor;\n                if (x && y) {\n                    x -= bbox.left;\n                    y -= bbox.top;\n                    if ((x !== this.activeObj.activePoint.startX / ratio.width) && (y !== this.activeObj.activePoint.startY /\n                        ratio.height)) {\n                        this.updateTextFromTextArea(ratio);\n                        this.applyActObj();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea(ratio);\n                    this.apply(this.activeObj.shape, this.activeObj);\n                    this.objColl.push(this.activeObj);\n                    this.refreshActiveObj();\n                    this.textBox.style.transform = '';\n                    this.refreshToolbar('main');\n                }\n            }\n            else {\n                this.applyActObj();\n            }\n        }\n    };\n    ImageEditor.prototype.setTextBoxPos = function (actObj, degree, flip, x, y, ratio) {\n        var point = { x: x, y: y };\n        if (degree === 0) {\n            if (flip.toLowerCase() === 'horizontal') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left) +\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) + actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left) -\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) - actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n            else {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n        }\n        else if (degree === 90) {\n            if (flip.toLowerCase() === 'horizontal') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n            else {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left) +\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) + actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n        }\n        else if (degree === 180) {\n            if (flip.toLowerCase() === 'horizontal') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n            else {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left) +\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) + actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n        }\n        else if (degree === 270) {\n            if (flip.toLowerCase() === 'horizontal') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left) +\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) + actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left) -\n                        actObj.activePoint.width / ratio.width;\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                }\n                else {\n                    point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left) - actObj.activePoint.width;\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top);\n                }\n            }\n            else {\n                if (this.factor === 1) {\n                    point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                        actObj.activePoint.height / ratio.height;\n                }\n                else {\n                    point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                        + parseFloat(this.lowerCanvas.style.left);\n                    point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                        + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                }\n            }\n        }\n        return point;\n    };\n    ImageEditor.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y, ratio) {\n        var point = { x: x, y: y };\n        if (degree === 0) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                            actObj.activePoint.height / ratio.height;\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                            actObj.activePoint.height / ratio.height;\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                    }\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left +\n                            actObj.activePoint.width / ratio.width);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                            actObj.activePoint.height / ratio.height;\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left) + actObj.activePoint.width;\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n        }\n        else if (degree === 90) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top) +\n                            actObj.activePoint.height / ratio.height;\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top) + actObj.activePoint.height;\n                    }\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n        }\n        else if (degree === 180) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left)\n                            + actObj.activePoint.width / ratio.width;\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n        }\n        else if (degree === 270) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.startX / ratio.width) + parseFloat(this.lowerCanvas.style.left) +\n                            actObj.activePoint.width / ratio.width;\n                        point.y = (actObj.activePoint.startY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.startX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.startY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    if (this.factor === 1) {\n                        point.x = (actObj.activePoint.endX / ratio.width) + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY / ratio.height) + parseFloat(this.lowerCanvas.style.top);\n                    }\n                    else {\n                        point.x = (actObj.activePoint.endX - ((this.pannStart.startX) / ratio.width * this.factor))\n                            + parseFloat(this.lowerCanvas.style.left);\n                        point.y = (actObj.activePoint.endY - ((this.pannStart.startY) / ratio.height * this.factor))\n                            + parseFloat(this.lowerCanvas.style.top);\n                    }\n                }\n            }\n        }\n        return point;\n    };\n    ImageEditor.prototype.findTextTarget = function (e) {\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.upperCanvas.getBoundingClientRect();\n        var ratio = this.calcRatio();\n        var degree;\n        var flip = '';\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (this.activeObj.shapeFlip === this.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = this.currFlipState;\n        }\n        var temp;\n        if (this.textBox.style.display === 'block') {\n            x -= bbox.left;\n            y -= bbox.top;\n        }\n        else {\n            temp = extend({}, this.activeObj, {}, true);\n            for (var i = 0; i < this.objColl.length; i++) {\n                if (JSON.stringify(this.activeObj) === JSON.stringify(this.objColl[i])) {\n                    this.objColl.splice(i, 1);\n                }\n            }\n            this.lowerContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.apply(this.objColl[i].shape, this.objColl[i]);\n            }\n            this.activeObj = temp;\n            this.updateFontStyles();\n            if (this.factor === 1) {\n                x = (x - bbox.left) * ratio.width;\n                y = (y - bbox.top) * ratio.height;\n            }\n            else {\n                x = (x - bbox.left) + ((this.pannStart.startX) / ratio.width * this.factor);\n                y = (y - bbox.top) + ((this.pannStart.startY) / ratio.height * this.factor);\n            }\n            var actObj = extend({}, this.activeObj, {}, true);\n            if (this.factor !== 1) {\n                actObj = this.setCursorForZoomState(actObj, ratio, true);\n            }\n            if (x >= (actObj.activePoint.startX - actObj.topLeftCircle.radius) &&\n                x <= (actObj.activePoint.endX + actObj.topLeftCircle.radius) &&\n                y >= (actObj.activePoint.startY - actObj.topLeftCircle.radius) &&\n                y <= (actObj.activePoint.endY + actObj.topLeftCircle.radius)) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (actObj.flipObjColl.length === 4) {\n                    actObj.flipObjColl = [];\n                    flip = '';\n                }\n                if (flip === '' && actObj.flipObjColl.length > 1) {\n                    flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                }\n                if (actObj.flipObjColl.length <= 1) {\n                    var points = this.setTextBoxPos(actObj, degree, flip, x, y, ratio);\n                    x = points.x;\n                    y = points.y;\n                }\n                else {\n                    var points = this.setTextBoxPoints(actObj, degree, flip, x, y, ratio);\n                    x = points.x;\n                    y = points.y;\n                }\n                this.textBox.style.display = 'block';\n                this.textBox.style.left = x + 'px';\n                this.textBox.style.top = y + 'px';\n                this.textBox.style.fontFamily = actObj.textSettings.fontFamily;\n                this.textBox.style.fontSize = actObj.textSettings.fontSize / ((ratio.width + ratio.height) / 2) * this.factor + 'px';\n                this.textBox.style.color = actObj.strokeSettings.strokeColor;\n                this.textBox.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n                this.textBox.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n                this.textBox.style.border = '2px solid ' + this.themeColl[this.theme]['primaryColor'];\n                this.textBox.value = actObj.keyHistory;\n                this.textBox.style.overflow = 'hidden';\n                this.textBox.style.height = 'auto';\n                if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n                    if (this.factor === 1) {\n                        this.textBox.style.width = (actObj.activePoint.height / ratio.height) + 'px';\n                        this.textBox.style.height = (actObj.activePoint.width / ratio.width) + 'px';\n                    }\n                    else {\n                        this.textBox.style.width = actObj.activePoint.height + 'px';\n                        this.textBox.style.height = actObj.activePoint.width + 'px';\n                    }\n                }\n                else {\n                    if (this.factor === 1) {\n                        this.textBox.style.width = (actObj.activePoint.width / ratio.width) + 'px';\n                        this.textBox.style.height = (actObj.activePoint.height / ratio.height) + 'px';\n                    }\n                    else {\n                        this.textBox.style.width = actObj.activePoint.width + 'px';\n                        this.textBox.style.height = actObj.activePoint.height + 'px';\n                    }\n                }\n                this.setTextBoxWidth();\n                this.setTextBoxHeight();\n            }\n            else {\n                this.applyActObj();\n            }\n        }\n    };\n    ImageEditor.prototype.setTextBoxHeight = function () {\n        var ratio = this.calcRatio();\n        var textBoxTop;\n        var degree;\n        var flip = '';\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (this.factor !== 1) {\n            actObj = this.setCursorForZoomState(actObj, ratio, true);\n        }\n        if (actObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shapeFlip === this.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = this.currFlipState;\n        }\n        if (degree === 0) {\n            if (flip.toLowerCase() === 'vertical') {\n                this.textBox.style.maxHeight = (parseFloat(this.lowerCanvas.style.maxHeight) - (parseFloat(this.lowerCanvas.style.maxHeight)\n                    - parseFloat(this.textBox.style.top))) + 'px';\n            }\n            else {\n                textBoxTop = parseFloat(this.textBox.style.top) - parseFloat(this.lowerCanvas.style.top);\n                this.textBox.style.maxHeight = (parseFloat(this.lowerCanvas.style.maxHeight) - textBoxTop) + 'px';\n            }\n        }\n        else if (degree === 90) {\n            if (flip.toLowerCase() === 'horizontal') {\n                this.textBox.style.maxHeight = (parseFloat(this.lowerCanvas.style.maxWidth) - (parseFloat(this.textBox.style.left)\n                    - parseFloat(this.lowerCanvas.style.left))) + 'px';\n            }\n            else {\n                this.textBox.style.maxHeight = (parseFloat(this.textBox.style.left)\n                    - parseFloat(this.lowerCanvas.style.left)) + 'px';\n            }\n        }\n        else if (degree === 180) {\n            if (flip.toLowerCase() === 'vertical') {\n                textBoxTop = parseFloat(this.textBox.style.top) - parseFloat(this.lowerCanvas.style.top);\n                this.textBox.style.maxHeight = (parseFloat(this.lowerCanvas.style.maxHeight) - textBoxTop) + 'px';\n            }\n            else {\n                this.textBox.style.maxHeight = (parseFloat(this.textBox.style.top)\n                    - parseFloat(this.lowerCanvas.style.top)) + 'px';\n            }\n        }\n        else if (degree === 270) {\n            if (flip.toLowerCase() === 'horizontal') {\n                this.textBox.style.maxHeight = (parseFloat(this.textBox.style.left)\n                    - parseFloat(this.lowerCanvas.style.left)) + 'px';\n            }\n            else {\n                this.textBox.style.maxHeight = parseFloat(this.lowerCanvas.style.maxWidth) - (parseFloat(this.textBox.style.left)\n                    - parseFloat(this.lowerCanvas.style.left)) + 'px';\n            }\n        }\n        this.textBox.style.maxHeight = ((parseFloat(this.textBox.style.maxHeight) - parseFloat(this.textBox.style.fontSize) * 0.5)) + 'px';\n    };\n    ImageEditor.prototype.setTextBoxWidth = function (e) {\n        var ratio = this.calcRatio();\n        var text = this.getMaxText(true);\n        if (this.textBox.style.display === 'block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textBoxWidth = (this.upperContext.measureText(text).width + (parseFloat(this.textBox.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (this.factor !== 1) {\n            actObj = this.setCursorForZoomState(actObj, ratio, true);\n        }\n        var degree;\n        var flip = '';\n        if (actObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shapeFlip === this.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = this.currFlipState;\n        }\n        if ((!isNullOrUndefined(e) && parseFloat(this.textBox.style.width) < (textBoxWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(this.textBox.style.left) - parseFloat(this.lowerCanvas.style.left)) - textBoxWidth - letterWidth > 0) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.lowerCanvas.style.maxWidth) - (parseFloat(this.textBox.style.left)\n                        - parseFloat(this.lowerCanvas.style.left))) > (textBoxWidth + letterWidth)) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(this.textBox.style.top) - parseFloat(this.lowerCanvas.style.top)) - textBoxWidth - letterWidth > 0) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.lowerCanvas.style.maxHeight) - (parseFloat(this.textBox.style.top)\n                        - parseFloat(this.lowerCanvas.style.top))) > (textBoxWidth + letterWidth)) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 180) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(this.lowerCanvas.style.maxWidth) - (parseFloat(this.textBox.style.left)\n                        - parseFloat(this.lowerCanvas.style.left))) > (textBoxWidth + letterWidth)) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.textBox.style.left) - parseFloat(this.lowerCanvas.style.left)) - textBoxWidth - letterWidth > 0) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(this.lowerCanvas.style.maxHeight) - (parseFloat(this.textBox.style.top)\n                        - parseFloat(this.lowerCanvas.style.top))) > (textBoxWidth + letterWidth)) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.textBox.style.top) - parseFloat(this.lowerCanvas.style.top)) - textBoxWidth - letterWidth > 0) {\n                        this.textBox.style.width = (textBoxWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.setActivePoint = function (startX, startY) {\n        if (isNullOrUndefined(this.activeObj.activePoint)) {\n            return;\n        }\n        if (this.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : this.activeObj.textSettings.fontSize;\n            if (this.activeObj.textSettings.fontSize === undefined) {\n                this.activeObj.textSettings.fontSize = (Math.abs(this.baseImg.width - this.baseImg.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = this.activeObj.activePoint.endX;\n            this.mouseDownPoint.y = this.activeObj.activePoint.endY;\n            if (this.activeObj.horTopLine !== undefined) {\n                this.activeObj.activePoint = extend({}, this.activeObj.activePoint, {}, true);\n            }\n            this.drawObject('duplicate');\n        }\n        else if (startX && startY) {\n            this.activeObj.activePoint.startX = this.mouseDownPoint.x = startX;\n            this.activeObj.activePoint.startY = this.mouseDownPoint.y = startY;\n            this.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = this.activeObj;\n            this.activeObj.activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.updateActivePoint = function (x, y) {\n        var initialDraw = false;\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        var ratio = this.calcRatio();\n        if (this.dragElement !== '') {\n            if (this.factor === 1) {\n                x = (x - bbox.left) * ratio.width;\n                y = (y - bbox.top) * ratio.height;\n            }\n            else {\n                x = ((x - bbox.left) * ratio.width) / this.factor + this.pannStart.startX;\n                y = ((y - bbox.top) * ratio.height) / this.factor + this.pannStart.startY;\n            }\n        }\n        var maxDimension = this.calcMaxDimension(this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        var shapeResizingArgs = { action: 'resize', previousShapeSettings: this.activeObj };\n        var shapeMovingArgs = { action: 'move', previousShapeSettings: this.activeObj };\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y, maxDimension);\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y, maxDimension);\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y, maxDimension);\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y, maxDimension);\n                break;\n            default:\n                if (this.dragPoint.startX) {\n                    var width = (this.dragPoint.endX - this.previousPoint.x);\n                    var height = (this.dragPoint.endY - this.previousPoint.y);\n                    if (this.factor !== 1) {\n                        width = (width * ratio.width) / this.factor;\n                        height = (height * ratio.height) / this.factor;\n                    }\n                    this.activeObj.activePoint.startX += width;\n                    this.activeObj.activePoint.endX += width;\n                    this.activeObj.activePoint.startY += height;\n                    this.activeObj.activePoint.endY += height;\n                    var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                    if (this.activeObj.shape !== 'text' && !this.allowDrag) {\n                        if (this.factor > 1 && (this.activeObj.activePoint.startX < this.pannStart.startX ||\n                            this.activeObj.activePoint.endX > endPoint.x) && (this.activeObj.activePoint.startY < this.pannStart.startY ||\n                            this.activeObj.activePoint.endY > endPoint.y)) {\n                            this.activeObj.activePoint.startX -= width;\n                            this.activeObj.activePoint.endX -= width;\n                            this.activeObj.activePoint.startY -= height;\n                            this.activeObj.activePoint.endY -= height;\n                        }\n                        else if (this.factor > 1 && (this.activeObj.activePoint.startX < this.pannStart.startX ||\n                            this.activeObj.activePoint.endX > endPoint.x)) {\n                            this.activeObj.activePoint.startX -= width;\n                            this.activeObj.activePoint.endX -= width;\n                        }\n                        else if (this.factor > 1 && (this.activeObj.activePoint.startY < this.pannStart.startY ||\n                            this.activeObj.activePoint.endY > endPoint.y)) {\n                            this.activeObj.activePoint.startY -= height;\n                            this.activeObj.activePoint.endY -= height;\n                        }\n                    }\n                    if (this.activeObj.activePoint.startX >= this.pannStart.startX && this.activeObj.activePoint.startY >=\n                        this.pannStart.startY && this.activeObj.activePoint.endX <= endPoint.x && this.activeObj.activePoint.endY\n                        <= endPoint.y) {\n                        this.allowDrag = false;\n                    }\n                }\n                else {\n                    this.activeObj.activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                    this.activeObj.activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                    if (this.factor === 1) {\n                        this.activeObj.activePoint.startX = (this.activeObj.activePoint.startX - bbox.left) * ratio.width;\n                        this.activeObj.activePoint.startY = (this.activeObj.activePoint.startY - bbox.top) * ratio.height;\n                        initialDraw = false;\n                    }\n                    else {\n                        this.activeObj.activePoint.startX = (this.activeObj.activePoint.startX - bbox.left) + ((this.pannStart.startX)\n                            / ratio.width * this.factor);\n                        this.activeObj.activePoint.startY = (this.activeObj.activePoint.startY - bbox.top) + ((this.pannStart.startY)\n                            / ratio.height * this.factor);\n                        initialDraw = true;\n                    }\n                    x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                    y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                    if (this.factor === 1) {\n                        this.activeObj.activePoint.endX = (x - bbox.left) * ratio.width;\n                        this.activeObj.activePoint.endY = (y - bbox.top) * ratio.height;\n                        initialDraw = false;\n                    }\n                    else {\n                        this.activeObj.activePoint.endX = (x - bbox.left) + ((this.pannStart.startX) / ratio.width * this.factor);\n                        this.activeObj.activePoint.endY = (y - bbox.top) + ((this.pannStart.startY) / ratio.height * this.factor);\n                        initialDraw = true;\n                    }\n                }\n                break;\n        }\n        shapeResizingArgs.currentShapeSettings = this.activeObj;\n        shapeMovingArgs.currentShapeSettings = this.activeObj;\n        this.trigger('shapeChanging', shapeMovingArgs);\n        this.trigger('shapeChanging', shapeResizingArgs);\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        return initialDraw;\n    };\n    ImageEditor.prototype.updateNWPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = this.activeObj.activePoint.startX - x;\n                this.diffPoint.y = this.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = diff / 10;\n            this.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            var degree = void 0;\n            var maxText = this.getMaxText();\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree === 0 || degree === 180) {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.width / maxText.length) * 2;\n            }\n            else {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.height / maxText.length) * 2;\n            }\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.startY = y;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'ne-resize';\n                }\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 'sw-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.startY < y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.updateNPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startY = y;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 's-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.startY < y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = this.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateNEPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - this.activeObj.activePoint.endX;\n                this.diffPoint.y = this.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = diff / 10;\n            this.activeObj.activePoint.endX += (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            var degree = void 0;\n            var maxText = this.getMaxText();\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree === 0 || degree === 180) {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.width / maxText.length) * 2;\n            }\n            else {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.height / maxText.length) * 2;\n            }\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.startY = y;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'nw-resize';\n                }\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 'se-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.startY < y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = this.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.startY < 0) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.updateWPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'e-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.endY > y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateEPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'w-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateSWPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = this.activeObj.activePoint.startX - x;\n                this.diffPoint.y = y - this.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = diff / 10;\n            this.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.endY += (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            var degree = void 0;\n            var maxText = this.getMaxText();\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree === 0 || degree === 180) {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.width / maxText.length) * 2;\n            }\n            else {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.height / maxText.length) * 2;\n            }\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.endY = y;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'se-resize';\n                }\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'nw-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.endY > y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.startX < 0 || this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.updateSPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endY = y;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'n-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.x;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateSEPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - this.activeObj.activePoint.endX;\n                this.diffPoint.y = y - this.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x >= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = diff / 10;\n            this.activeObj.activePoint.endX += (maxDimension.width / 50) * percentage;\n            this.activeObj.activePoint.endY += (maxDimension.height / 50) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            var degree = void 0;\n            var maxText = this.getMaxText();\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree === 0 || degree === 180) {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.width / maxText.length) * 2;\n            }\n            else {\n                this.activeObj.textSettings.fontSize = (this.activeObj.activePoint.height / maxText.length) * 2;\n            }\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.endY = y;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'sw-resize';\n                }\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'ne-resize';\n                }\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var ratio = this.activeObj.shape.split('-');\n                    ratio = ratio[1].split(':');\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.endX > this.lowerCanvas.width || this.activeObj.activePoint.endY >\n                        this.lowerCanvas.height) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.getScaleRatio = function (scale) {\n        var point = { x: scale, y: scale };\n        if (!this.currObjType.isCustomCrop && this.activeObj.shape !== 'crop-circle' && this.activeObj.shape !== 'crop-square') {\n            var ratio = this.activeObj.shape.split('-');\n            ratio = ratio[1].split(':');\n            var newScale = scale / (parseInt(ratio[1], 10));\n            point.x = newScale * (parseInt(ratio[0], 10));\n            point.y = newScale * (parseInt(ratio[1], 10));\n        }\n        return point;\n    };\n    ImageEditor.prototype.getMaxText = function (isTextBox) {\n        var text = isTextBox ? this.textBox.value : this.activeObj.keyHistory;\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        return maxText;\n    };\n    ImageEditor.prototype.setDragLimit = function () {\n        if (this.factor === 1 && this.activeObj.activePoint !== undefined && this.activeObj.shape !== 'text') {\n            if (this.activeObj.activePoint.startX < 0) {\n                this.activeObj.activePoint.startX = 0;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.width;\n            }\n            else if (this.activeObj.activePoint.endX > this.lowerCanvas.width) {\n                this.activeObj.activePoint.endX = this.lowerCanvas.width;\n                this.activeObj.activePoint.startX = this.lowerCanvas.width - this.activeObj.activePoint.width;\n            }\n            if (this.activeObj.activePoint.startY < 0) {\n                this.activeObj.activePoint.startY = 0;\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.height;\n            }\n            else if (this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                this.activeObj.activePoint.endY = this.lowerCanvas.height;\n                this.activeObj.activePoint.startY = this.lowerCanvas.height - this.activeObj.activePoint.height;\n            }\n        }\n    };\n    ImageEditor.prototype.lineDraw = function (ratio) {\n        if (this.activeObj.activePoint.height < 10 * ratio.height) {\n            this.activeObj.activePoint.startY -= 10 * ratio.height;\n            this.activeObj.activePoint.endY += 10 * ratio.height;\n            this.activeObj.lineDraw = 'horizontal';\n        }\n        else if (this.activeObj.activePoint.width < 10 * ratio.width) {\n            this.activeObj.activePoint.startX -= 10 * ratio.width;\n            this.activeObj.activePoint.endX += 10 * ratio.width;\n            this.activeObj.lineDraw = 'vertical';\n        }\n        else if (this.currObjType.isInitialLine) {\n            this.activeObj.lineDraw = 'normal';\n            this.currObjType.isInitialLine = false;\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n    };\n    ImageEditor.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        var ratio = this.calcRatio();\n        canvasDraw.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.5)';\n        canvasDraw.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2 * (ratio.width + ratio.height)) / this.factor;\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(this.activeObj.horTopLine.startX + (selectionWidth / 2), this.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((this.activeObj.activePoint.endX - this.activeObj.activePoint.startX) / 2) + this.activeObj.activePoint.startX, ((this.activeObj.activePoint.endY - this.activeObj.activePoint.startY) / 2) + this.activeObj.activePoint.startY, (this.activeObj.activePoint.width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, null, true);\n        this.currObjType.shape = '';\n    };\n    ImageEditor.prototype.drawOuterSelection = function (canvasDraw, isInitialDraw, isCropCircle) {\n        var splitWords;\n        var ratio = this.calcRatio();\n        canvasDraw.lineWidth = (0.5 * (ratio.width + ratio.height)) / this.factor;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        var tempObj = extend({}, this.activeObj, {}, true);\n        if (this.factor !== 1) {\n            if (isInitialDraw) {\n                tempObj = this.getZoomShape(tempObj, ratio);\n            }\n        }\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (((splitWords !== undefined && splitWords[0] === 'crop') || this.activeObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.5)';\n            this.upperContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        }\n        canvasDraw.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        canvasDraw.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n        if (this.activeObj.shape !== 'rectangle') {\n            canvasDraw.beginPath();\n            canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n        canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n        canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n        canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n        canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        canvasDraw.lineWidth /= 2;\n        if ((splitWords === undefined || splitWords[0] !== 'crop') && this.activeObj.shape !== 'text') {\n            this.drawCenterCircles(canvasDraw);\n        }\n        this.activeObj = extend({}, tempObj, {}, true);\n    };\n    ImageEditor.prototype.getZoomShape = function (tempObj, ratio) {\n        var obj = extend({}, tempObj, {}, true);\n        obj.activePoint.startX = (obj.activePoint.startX / this.factor) * ratio.width;\n        obj.activePoint.startY = (obj.activePoint.startY / this.factor) * ratio.height;\n        obj.activePoint.endX = (obj.activePoint.endX / this.factor) * ratio.width;\n        obj.activePoint.endY = (obj.activePoint.endY / this.factor) * ratio.height;\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        this.updateActiveObject(ratio, obj.activePoint, obj);\n        return obj;\n    };\n    ImageEditor.prototype.drawObject = function (canvas, obj, isInitialDraw, isCropRatio, points) {\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else {\n            canvasDraw = this.upperContext;\n        }\n        this.setDragLimit();\n        var ratio = this.calcRatio();\n        if (this.currObjType.isLine && canvas !== 'original' && !obj) {\n            this.lineDraw(ratio);\n        }\n        var splitWords = this.currObjType.shape.split('-');\n        if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n            this.drawCropRatio();\n        }\n        if (points) {\n            this.activeObj.activePoint.startX = points.startX;\n            this.activeObj.activePoint.startY = points.startY;\n            this.activeObj.activePoint.endX = points.endX;\n            this.activeObj.activePoint.endY = points.endY;\n            this.activeObj.activePoint.width = points.width;\n            this.activeObj.activePoint.height = points.height;\n        }\n        if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n            this.activeObj.strokeSettings = this.strokeSettings;\n        }\n        if (isNullOrUndefined(this.activeObj.strokeSettings.strokeWidth)) {\n            this.activeObj.strokeSettings.strokeWidth = 2 * (ratio.width + ratio.height) / this.factor;\n        }\n        if (obj) {\n            this.activeObj = extend({}, obj, {}, true);\n            if (this.factor !== 1) {\n                this.updateActiveObject(ratio);\n            }\n        }\n        else {\n            this.updateActiveObject(ratio);\n        }\n        if (this.currObjType.isText) {\n            this.activeObj.keyHistory = this.keyHistory;\n        }\n        if (canvas.toLowerCase() !== 'original') {\n            var splitWords_1;\n            var isCrop = false;\n            if (this.activeObj.shape) {\n                splitWords_1 = this.activeObj.shape.split('-');\n                if (splitWords_1[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.5)';\n                this.upperContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.upperContext.clearRect(this.activeObj.activePoint.startX + ratio.width, this.activeObj.activePoint.startY + ratio.height, this.activeObj.activePoint.width - ratio.width, this.activeObj.activePoint.height - ratio.height);\n            }\n            this.drawOuterSelection(canvasDraw, isInitialDraw);\n        }\n        this.currObjType.isActiveObj = true;\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape);\n        }\n        else if (this.keyHistory !== '' && this.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text');\n        }\n        else if (this.activeObj.shape) {\n            this.drawShapeObj(canvas, this.activeObj.shape);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined);\n        }\n    };\n    ImageEditor.prototype.updateActiveObject = function (ratio, actPoint, obj, isMouseMove) {\n        actPoint = actPoint ? actPoint : extend({}, this.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, this.activeObj, {}, true);\n        var horCircleWidth = actPoint.width / 2;\n        var verCircleHeight = actPoint.height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: actPoint.startX, startY: actPoint.startY,\n            endX: actPoint.endX, endY: actPoint.endY };\n        obj.horBottomLine = { startX: actPoint.startX, startY: actPoint.endY,\n            endX: actPoint.endX, endY: actPoint.endY };\n        obj.verLeftLine = { startX: actPoint.startX, startY: actPoint.startY,\n            endX: actPoint.startX, endY: actPoint.endY };\n        obj.verRightLine = { startX: actPoint.endX, startY: actPoint.startY,\n            endX: actPoint.endX, endY: actPoint.endY };\n        obj.topLeftCircle = { startX: actPoint.startX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.topCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.topRightCircle = { startX: actPoint.endX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.centerLeftCircle = { startX: actPoint.startX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.centerRightCircle = { startX: actPoint.endX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.bottomLeftCircle = { startX: actPoint.startX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.bottomCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.bottomRightCircle = { startX: actPoint.endX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor : 0 };\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            this.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    ImageEditor.prototype.drawShapeObj = function (canvas, shape) {\n        var currentShape = shape !== undefined ? shape : this.currObjType.shape;\n        this.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else {\n            canvasDraw = this.upperContext;\n        }\n        if (this.currObjType.shape.toLowerCase() === 'rectangle' || this.currObjType.shape.toLowerCase() === 'ellipse'\n            || this.currObjType.shape.toLowerCase() === 'line') {\n            this.activeObj.shape = this.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n        }\n        var horLineWidth = this.activeObj.activePoint.width / 3;\n        var verLineHeight = this.activeObj.activePoint.height / 3;\n        var selectionWidth = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        var selectionHeight = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        switch (this.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'ellipse':\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(this.activeObj.activePoint.startX + (selectionWidth / 2), this.activeObj.activePoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (this.activeObj.strokeSettings.fillColor !== '') {\n                    canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(this.activeObj.activePoint.startX + (selectionWidth / 2), this.activeObj.activePoint.startY + (selectionHeight / 2), (selectionWidth / 2) - (this.activeObj.strokeSettings.strokeWidth), (selectionHeight / 2) - (this.activeObj.strokeSettings.strokeWidth), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, selectionWidth, selectionHeight);\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                this.drawSelection(horLineWidth, verLineHeight);\n                this.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n    };\n    ImageEditor.prototype.shapeLine = function (canvasDraw, selectionWidth, selectionHeight) {\n        var startX;\n        var startY;\n        var endX;\n        var endY;\n        var degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree === 0 || degree % 180 === 0) {\n            startX = this.activeObj.activePoint.startX;\n            startY = this.activeObj.activePoint.startY + (selectionHeight / 2);\n            endX = this.activeObj.activePoint.endX;\n            endY = this.activeObj.activePoint.startY + (selectionHeight / 2);\n        }\n        else {\n            startX = this.activeObj.activePoint.startX + (selectionWidth / 2);\n            startY = this.activeObj.activePoint.startY;\n            endX = this.activeObj.activePoint.startX + (selectionWidth / 2);\n            endY = this.activeObj.activePoint.endY;\n        }\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.activeObj.strokeSettings.strokeWidth) / Math.abs(this.factor);\n        canvasDraw.beginPath();\n        switch (this.activeObj.lineDraw.toLowerCase()) {\n            case 'horizontal':\n            case 'vertical':\n                canvasDraw.moveTo(startX, startY);\n                canvasDraw.lineTo(endX, endY);\n                break;\n            case 'normal':\n                canvasDraw.moveTo(this.activeObj.horTopLine.startX, this.activeObj.horTopLine.startY);\n                canvasDraw.lineTo(this.activeObj.horBottomLine.endX, this.activeObj.horBottomLine.endY);\n                break;\n        }\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    ImageEditor.prototype.shapeText = function (canvasDraw) {\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n        var lineHeight = ((height * rows.length) - (this.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * this.activeObj.textSettings.fontSize * 0.85) + (i * lineHeight);\n            if (this.degree === -360) {\n                this.degree = 0;\n            }\n            if (this.degree === 0 || this.degree === 180) {\n                if (this.activeObj.textSettings.fontSize > this.activeObj.activePoint.height) {\n                    this.activeObj.textSettings.fontSize = this.activeObj.activePoint.height -\n                        (this.activeObj.activePoint.height * 0.1);\n                }\n            }\n            else {\n                if (this.activeObj.textSettings.fontSize > this.activeObj.activePoint.width) {\n                    this.activeObj.textSettings.fontSize = this.activeObj.activePoint.width -\n                        (this.activeObj.activePoint.width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n            var textStyle = '';\n            if (this.activeObj.textSettings.bold) {\n                textStyle = 'bold ';\n            }\n            if (this.activeObj.textSettings.italic) {\n                textStyle = 'italic ';\n            }\n            if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            if (this.activeObj.flipObjColl.length === 4) {\n                this.activeObj.flipObjColl = [];\n            }\n            for (var j = 0; j < this.activeObj.flipObjColl.length; j++) {\n                if (this.activeObj.flipObjColl[j].toLowerCase() === 'horizontal') {\n                    this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n                    this.lowerContext.scale(-1, 1);\n                    this.upperContext.translate(this.upperContext.canvas.width, 0);\n                    this.upperContext.scale(-1, 1);\n                    this.updateActPoint('horizontal');\n                }\n                else if (this.activeObj.flipObjColl[j].toLowerCase() === 'vertical') {\n                    this.lowerContext.translate(0, this.lowerContext.canvas.height);\n                    this.lowerContext.scale(1, -1);\n                    this.upperContext.translate(0, this.upperContext.canvas.height);\n                    this.upperContext.scale(1, -1);\n                    this.updateActPoint('vertical');\n                }\n            }\n            if (this.activeObj.shapeDegree !== this.degree) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.fillText(text, this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.1, this.activeObj.activePoint.startY + yPoint);\n            }\n            for (var k = 0; k < this.activeObj.flipObjColl.length; k++) {\n                if (this.activeObj.flipObjColl[k].toLowerCase() === 'horizontal') {\n                    this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n                    this.lowerContext.scale(-1, 1);\n                    this.upperContext.translate(this.upperContext.canvas.width, 0);\n                    this.upperContext.scale(-1, 1);\n                    this.updateActPoint('horizontal');\n                }\n                else if (this.activeObj.flipObjColl[k].toLowerCase() === 'vertical') {\n                    this.lowerContext.translate(0, this.lowerContext.canvas.height);\n                    this.lowerContext.scale(1, -1);\n                    this.upperContext.translate(0, this.upperContext.canvas.height);\n                    this.upperContext.scale(1, -1);\n                    this.updateActPoint('vertical');\n                }\n            }\n        }\n        this.currObjType.isText = false;\n    };\n    ImageEditor.prototype.updateActPoint = function (degree) {\n        var ratio = this.calcRatio();\n        if (degree.toLowerCase() === 'horizontal') {\n            if (this.activeObj.activePoint.startX <= this.lowerCanvas.width / 2) {\n                this.activeObj.activePoint.startX = this.lowerCanvas.width / 2 + ((this.lowerCanvas.width / 2) -\n                    this.activeObj.activePoint.endX);\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n            }\n            else if (this.activeObj.activePoint.startX >= this.lowerCanvas.width / 2) {\n                this.activeObj.activePoint.startX = this.lowerCanvas.width - this.activeObj.activePoint.endX;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (this.activeObj.activePoint.startY <= this.lowerCanvas.height / 2) {\n                this.activeObj.activePoint.startY = this.lowerCanvas.height / 2 + ((this.lowerCanvas.height / 2) -\n                    this.activeObj.activePoint.endY);\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n            }\n            else if (this.activeObj.activePoint.startY >= this.lowerCanvas.height / 2) {\n                this.activeObj.activePoint.startY = this.lowerCanvas.height - this.activeObj.activePoint.endY;\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n            }\n        }\n    };\n    ImageEditor.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        }\n        canvasDraw.beginPath();\n        canvasDraw.rect(this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        if (this.activeObj.strokeSettings.fillColor !== '') {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n            canvasDraw.fill();\n        }\n        canvasDraw.rect(this.activeObj.activePoint.startX + this.activeObj.strokeSettings.strokeWidth, this.activeObj.activePoint.startY + this.activeObj.strokeSettings.strokeWidth, this.activeObj.activePoint.width - (2 * this.activeObj.strokeSettings.strokeWidth), this.activeObj.activePoint.height - (2 * this.activeObj.strokeSettings.strokeWidth));\n        canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    ImageEditor.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        this.activeObj.horTopInnerLine = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY +\n                verLineHeight, endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY + verLineHeight };\n        this.activeObj.horBottomInnerLine = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY +\n                (2 * verLineHeight), endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY + (2 * verLineHeight) };\n        this.activeObj.verLeftInnerLine = { startX: this.activeObj.activePoint.startX + horLineWidth,\n            startY: this.activeObj.activePoint.startY, endX: this.activeObj.activePoint.startX + horLineWidth,\n            endY: this.activeObj.activePoint.endY };\n        this.activeObj.verRightInnerLine = { startX: this.activeObj.activePoint.startX + (2 * horLineWidth),\n            startY: this.activeObj.activePoint.startY, endX: this.activeObj.activePoint.startX + (2 * horLineWidth),\n            endY: this.activeObj.activePoint.endY };\n        this.upperContext.moveTo(this.activeObj.horTopInnerLine.startX, this.activeObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.horTopInnerLine.endX, this.activeObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(this.activeObj.horBottomInnerLine.startX, this.activeObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.horBottomInnerLine.endX, this.activeObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(this.activeObj.verLeftInnerLine.startX, this.activeObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.verLeftInnerLine.endX, this.activeObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(this.activeObj.verRightInnerLine.startX, this.activeObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.verRightInnerLine.endX, this.activeObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    ImageEditor.prototype.drawCenterCircles = function (canvasDraw) {\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(this.activeObj.topCenterCircle.startX, this.activeObj.topCenterCircle.startY);\n        canvasDraw.arc(this.activeObj.topCenterCircle.startX, this.activeObj.topCenterCircle.startY, this.activeObj.topCenterCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.centerLeftCircle.startX, this.activeObj.centerLeftCircle.startY);\n        canvasDraw.arc(this.activeObj.centerLeftCircle.startX, this.activeObj.centerLeftCircle.startY, this.activeObj.centerLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.centerRightCircle.startX, this.activeObj.centerRightCircle.startY);\n        canvasDraw.arc(this.activeObj.centerRightCircle.startX, this.activeObj.centerRightCircle.startY, this.activeObj.centerRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.bottomCenterCircle.startX, this.activeObj.bottomCenterCircle.startY);\n        canvasDraw.arc(this.activeObj.bottomCenterCircle.startX, this.activeObj.bottomCenterCircle.startY, this.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        canvasDraw.lineWidth /= 2;\n    };\n    ImageEditor.prototype.findTarget = function (x, y, type) {\n        var bbox = this.upperCanvas.getBoundingClientRect();\n        var ratio = this.calcRatio();\n        if (this.factor === 1) {\n            x = (x - bbox.left) * ratio.width;\n            y = (y - bbox.top) * ratio.height;\n        }\n        else {\n            x = (x - bbox.left) + ((this.pannStart.startX) / ratio.width * this.factor);\n            y = (y - bbox.top) + ((this.pannStart.startY) / ratio.height * this.factor);\n        }\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (this.activeObj.shape) {\n                splitWords = this.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, ratio, isCrop);\n            this.updateCursorStyles(x, y, ratio, type);\n        }\n        else {\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    this.activeObj.topLeftCircle.startX = x;\n                    this.activeObj.topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    this.activeObj.topCenterCircle.startX = x;\n                    this.activeObj.topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    this.activeObj.topRightCircle.startX = x;\n                    this.activeObj.topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    this.activeObj.centerLeftCircle.startX = x;\n                    this.activeObj.centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    this.activeObj.centerRightCircle.startX = x;\n                    this.activeObj.centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    this.activeObj.bottomLeftCircle.startX = x;\n                    this.activeObj.bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    this.activeObj.bottomCenterCircle.startX = x;\n                    this.activeObj.bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    this.activeObj.bottomRightCircle.startX = x;\n                    this.activeObj.bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.findTargetObj = function (x, y, ratio, isCrop) {\n        if (this.objColl.length !== 0 && !this.currObjType.isCustomCrop && !isCrop) {\n            var diffX = 0;\n            var i = void 0;\n            for (var index = 0; index < this.objColl.length; index++) {\n                var actObj = extend({}, this.objColl[index], {}, true);\n                if (this.factor !== 1) {\n                    actObj = this.setCursorForZoomState(actObj, ratio);\n                }\n                if (x >= (actObj.activePoint.startX - actObj.topLeftCircle.radius) &&\n                    x <= (actObj.activePoint.endX + actObj.topLeftCircle.radius) &&\n                    y >= (actObj.activePoint.startY - actObj.topLeftCircle.radius) &&\n                    y <= (actObj.activePoint.endY + actObj.topLeftCircle.radius)) {\n                    if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                        diffX = x - this.objColl[index].activePoint.startX;\n                        i = index;\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                this.refreshActiveObj();\n                return;\n            }\n            this.currObjType.isCustomCrop = false;\n            var temp = this.activeObj = extend({}, this.objColl[i], {}, true);\n            this.objColl.splice(i, 1);\n            this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n            if (this.degree === 0) {\n                this.inMemoryContext.putImageData(this.imgDataColl[0].value, 0, 0);\n            }\n            else {\n                this.inMemoryCanvas.width = this.currImgData.width;\n                this.inMemoryCanvas.height = this.currImgData.height;\n                this.inMemoryContext.putImageData(this.currImgData, 0, 0);\n            }\n            if (this.flipState !== '') {\n                this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n                this.inMemoryCanvas.width = this.currImgData.width;\n                this.inMemoryCanvas.height = this.currImgData.height;\n                this.inMemoryContext.putImageData(this.currImgData, 0, 0);\n            }\n            this.setActivePoint();\n            this.upperContext.drawImage(this.inMemoryCanvas, 0, 0);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            for (var j = 0; j < this.objColl.length; j++) {\n                if (this.objColl[j].shape === 'text' && this.objColl[j].shapeFlip !== this.currFlipState) {\n                    this.objColl[j].flippedText = true;\n                }\n                this.apply(this.objColl[j].shape, this.objColl[j]);\n            }\n            this.activeObj = extend({}, temp, {}, true);\n            var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n            if (this.factor !== 1 && (this.activeObj.activePoint.startX < this.pannStart.startX || this.activeObj.activePoint.startY <\n                this.pannStart.startY) || (this.activeObj.activePoint.endX > endPoint.x || this.activeObj.activePoint.endY > endPoint.y)) {\n                this.allowDrag = true;\n            }\n            this.tempStrokeSettings = extend({}, this.activeObj.strokeSettings, {}, true);\n            this.tempTextSettings = extend({}, this.activeObj.textSettings, {}, true);\n            if (this.activeObj.shape === 'text' && this.activeObj.shapeFlip !== this.currFlipState) {\n                this.activeObj.flippedText = true;\n            }\n            if (this.activeObj.activePoint) {\n                this.drawObject('duplicate', this.activeObj);\n            }\n            var shapeChangingArgs = { action: 'select', previousShapeSettings: this.activeObj, currentShapeSettings: this.activeObj };\n            this.trigger('shapeChanging', shapeChangingArgs);\n        }\n    };\n    ImageEditor.prototype.updateCursorStyles = function (x, y, ratio, type) {\n        var isResize = false;\n        if (this.activeObj.keyHistory !== '' && this.activeObj.shape === undefined && !this.currObjType.isCustomCrop &&\n            !this.currObjType.isLine && this.currObjType.isText) {\n            this.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        if (this.factor !== 1) {\n            actObj = this.setCursorForZoomState(actObj, ratio, true);\n        }\n        if (x >= (actObj.topLeftCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.topLeftCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.topLeftCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.topLeftCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'nw-resize') {\n            actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'nw-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.topCenterCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.topCenterCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.topCenterCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.topCenterCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'n-resize') {\n            actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'n-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.topRightCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.topRightCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.topRightCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.topRightCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'ne-resize') {\n            actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'ne-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.centerLeftCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.centerLeftCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.centerLeftCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'w-resize') {\n            actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'w-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.centerRightCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.centerRightCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.centerRightCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.centerRightCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'e-resize') {\n            actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'e-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.bottomLeftCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.bottomLeftCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.bottomLeftCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'sw-resize') {\n            actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'sw-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomCenterCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.bottomCenterCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.bottomCenterCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.bottomCenterCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 's-resize') {\n            actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n            this.upperCanvas.style.cursor = 's-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - actObj.topLeftCircle.radius) &&\n            x <= (actObj.bottomRightCircle.startX + actObj.topLeftCircle.radius) &&\n            y >= (actObj.bottomRightCircle.startY - actObj.topLeftCircle.radius) &&\n            y <= (actObj.bottomRightCircle.startY + actObj.topLeftCircle.radius) && this.dragElement !== 'se-resize') {\n            actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'se-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY)) {\n                this.currObjType.isDragging = true;\n            }\n        }\n        else {\n            this.currObjType.isDragging = true;\n        }\n    };\n    ImageEditor.prototype.drawCropRatio = function () {\n        var x;\n        var y;\n        switch (this.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                this.setDragDirection();\n                if (this.lowerCanvas.width > this.lowerCanvas.height) {\n                    this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.width = this.activeObj.activePoint.height;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                }\n                else {\n                    this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.height = this.activeObj.activePoint.width;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            this.calcShapeRatio(x, y);\n        }\n    };\n    ImageEditor.prototype.setDragDirection = function () {\n        var ratio = this.calcRatio();\n        var arcRadius = (7.5 * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor;\n        if (this.lowerCanvas.width > this.lowerCanvas.height) {\n            if (this.factor === 1) {\n                this.activeObj.activePoint.startX = this.dragPoint.startX = ((this.lowerCanvas.width / 2) - (this.lowerCanvas.height / 2))\n                    + arcRadius;\n                this.activeObj.activePoint.startY = this.dragPoint.startY = ((this.lowerCanvas.height / 2) - (this.lowerCanvas.height / 2))\n                    + arcRadius;\n                this.activeObj.activePoint.endX = ((this.lowerCanvas.width / 2) + (this.lowerCanvas.height / 2)) - arcRadius;\n                this.activeObj.activePoint.endY = ((this.lowerCanvas.height / 2) + (this.lowerCanvas.height / 2)) - arcRadius;\n            }\n            else {\n                var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                var visibleWidth = endPoint.x - this.pannStart.startX;\n                var visibleHeight = endPoint.y - this.pannStart.startY;\n                var centerX = (this.dragPoint.startX = visibleWidth / 2) + this.pannStart.startX;\n                var centerY = this.dragPoint.startY = visibleHeight / 2;\n                this.activeObj.activePoint.startX = (centerX - centerY) + arcRadius;\n                this.activeObj.activePoint.startY = (this.pannStart.startY) + arcRadius;\n                this.activeObj.activePoint.endX = (this.activeObj.activePoint.startX + visibleHeight) - arcRadius;\n                this.activeObj.activePoint.endY = (this.activeObj.activePoint.startY + visibleHeight) - (2 * arcRadius);\n            }\n        }\n        else {\n            if (this.factor === 1) {\n                this.activeObj.activePoint.startY = this.dragPoint.startX = ((this.lowerCanvas.height / 2) - (this.lowerCanvas.width) / 2)\n                    + arcRadius;\n                this.activeObj.activePoint.endY = ((this.lowerCanvas.height / 2) + (this.lowerCanvas.width) / 2) - arcRadius;\n                this.activeObj.activePoint.startX = this.dragPoint.startX = arcRadius;\n                this.activeObj.activePoint.endX = this.lowerCanvas.width - arcRadius;\n            }\n            else {\n                var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                var visibleWidth = endPoint.x - this.pannStart.startX;\n                var visibleHeight = endPoint.y - this.pannStart.startY;\n                var centerX = this.dragPoint.startX = visibleWidth / 2;\n                var centerY = (this.dragPoint.startY = visibleHeight / 2) + this.pannStart.startY;\n                this.activeObj.activePoint.startX = this.pannStart.startX + arcRadius;\n                this.activeObj.activePoint.startY = (centerY - centerX) + arcRadius;\n                this.activeObj.activePoint.endX = (this.activeObj.activePoint.startX + visibleWidth) - arcRadius;\n                this.activeObj.activePoint.endY = (this.activeObj.activePoint.startY + visibleWidth) - arcRadius;\n            }\n        }\n    };\n    ImageEditor.prototype.calcShapeRatio = function (x, y) {\n        var ratio = this.calcRatio();\n        var arcRadius = (7.5 * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor;\n        var originalWidth = this.factor === 1 ? this.lowerCanvas.width : this.lowerCanvas.width / this.factor;\n        var originalHeight = this.factor === 1 ? this.lowerCanvas.height : this.lowerCanvas.height / this.factor;\n        var presetRatio = x / y;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        this.activeObj.activePoint.width = width;\n        this.activeObj.activePoint.height = height;\n        this.activeObj.activePoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        this.activeObj.activePoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        this.activeObj.activePoint.endX = ((originalWidth - width) / 2 + width) - arcRadius;\n        this.activeObj.activePoint.endY = ((originalHeight - height) / 2 + height) - arcRadius;\n        if (this.factor !== 1) {\n            this.activeObj.activePoint.startX += this.pannStart.startX;\n            this.activeObj.activePoint.startY += this.pannStart.startY;\n            this.activeObj.activePoint.endX += this.pannStart.startX;\n            this.activeObj.activePoint.endY += this.pannStart.startY;\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n    };\n    ImageEditor.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    ImageEditor.prototype.calcRatio = function () {\n        var widthRatio;\n        var heightRatio;\n        if (this.degree === 0 || this.degree % 180 === 0) {\n            widthRatio = this.baseImg.width / parseInt(this.lowerCanvas.style.maxWidth, 10);\n            heightRatio = this.baseImg.height / parseInt(this.lowerCanvas.style.maxHeight, 10);\n        }\n        else {\n            widthRatio = this.baseImg.height / parseInt(this.lowerCanvas.style.maxWidth, 10);\n            heightRatio = this.baseImg.width / parseInt(this.lowerCanvas.style.maxHeight, 10);\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    ImageEditor.prototype.calcMaxDimension = function (width, height) {\n        var canvasMaxWidth = this.element.clientWidth;\n        var canvasMaxHeight = this.element.clientHeight - this.toolbarHeight;\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - this.toolbarHeight : canvasMaxHeight;\n        canvasMaxWidth -= 30;\n        canvasMaxHeight -= 30;\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    ImageEditor.prototype.setMaximumDimension = function (degree) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            newWidth = this.baseImg.height;\n            newHeight = this.baseImg.width;\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            newWidth = this.baseImg.width;\n            newHeight = this.baseImg.height;\n        }\n        this.lowerCanvas.width = this.upperCanvas.width = newWidth;\n        this.lowerCanvas.height = this.upperCanvas.height = newHeight;\n        var maxDimension = this.calcMaxDimension(newWidth, newHeight);\n        this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n        this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    ImageEditor.prototype.setCursor = function (x, y) {\n        var bbox = this.upperCanvas.getBoundingClientRect();\n        var ratio = this.calcRatio();\n        if (this.factor === 1) {\n            x = (x - bbox.left) * ratio.width;\n            y = (y - bbox.top) * ratio.height;\n        }\n        else {\n            x = (x - bbox.left) + ((this.pannStart.startX) / ratio.width * this.factor);\n            y = (y - bbox.top) + ((this.pannStart.startY) / ratio.height * this.factor);\n        }\n        if (this.activeObj.horTopLine !== undefined) {\n            if (this.togglePan) {\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n            }\n            else {\n                var actObj = extend({}, this.activeObj, {}, true);\n                if (this.factor !== 1) {\n                    actObj = this.setCursorForZoomState(actObj, ratio, true);\n                }\n                if (x >= (actObj.topLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'nw-resize';\n                }\n                else if (x >= (actObj.topCenterCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topCenterCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topCenterCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topCenterCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'n-resize';\n                }\n                else if (x >= (actObj.topRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'ne-resize';\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.centerLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.centerLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.centerLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'w-resize';\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.centerRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.centerRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.centerRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'e-resize';\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'sw-resize';\n                }\n                else if (x >= (actObj.bottomCenterCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomCenterCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 's-resize';\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'se-resize';\n                }\n                else if ((x >= actObj.activePoint.startX &&\n                    x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n                    y <= actObj.activePoint.endY)) {\n                    this.upperCanvas.style.cursor = 'move';\n                }\n                else {\n                    if (this.currObjType.isCustomCrop) {\n                        this.upperCanvas.style.cursor = 'cross-hair';\n                    }\n                    this.upperCanvas.style.cursor = 'default';\n                }\n            }\n        }\n        else if (this.togglePan) {\n            this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n        }\n        else {\n            if (this.currObjType.isCustomCrop || this.togglePen) {\n                this.upperCanvas.style.cursor = 'crosshair';\n            }\n            else {\n                this.upperCanvas.style.cursor = 'default';\n            }\n        }\n        if (this.upperCanvas.style.cursor === 'default') {\n            if (this.objColl.length > 0) {\n                this.setCursorFromObj(x, y, this.objColl, ratio);\n            }\n        }\n    };\n    ImageEditor.prototype.setCursorFromObj = function (x, y, obj, ratio) {\n        if (this.togglePan) {\n            this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n        }\n        else {\n            for (var i = 0; i < obj.length; i++) {\n                var actObj = extend({}, obj[i], {}, true);\n                if (this.factor !== 1) {\n                    actObj = this.setCursorForZoomState(obj[i], ratio, true);\n                }\n                if (x >= (actObj.topLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'nw-resize';\n                    break;\n                }\n                else if (x >= (actObj.topCenterCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topCenterCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topCenterCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topCenterCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'n-resize';\n                    break;\n                }\n                else if (x >= (actObj.topRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.topRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.topRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.topRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'ne-resize';\n                    break;\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.centerLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.centerLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.centerLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'w-resize';\n                    break;\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.centerRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.centerRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.centerRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'e-resize';\n                    break;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'sw-resize';\n                    break;\n                }\n                else if (x >= (actObj.bottomCenterCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomCenterCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 's-resize';\n                    break;\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (actObj.topLeftCircle.radius)) &&\n                    x <= (actObj.bottomRightCircle.startX + (actObj.topLeftCircle.radius)) &&\n                    y >= (actObj.bottomRightCircle.startY - (actObj.topLeftCircle.radius)) &&\n                    y <= (actObj.bottomRightCircle.startY + (actObj.topLeftCircle.radius))) {\n                    this.upperCanvas.style.cursor = 'se-resize';\n                    break;\n                }\n                else if ((x >= actObj.activePoint.startX &&\n                    x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n                    y <= actObj.activePoint.endY)) {\n                    this.upperCanvas.style.cursor = 'move';\n                    break;\n                }\n                else {\n                    if (this.currObjType.isCustomCrop) {\n                        this.upperCanvas.style.cursor = 'cross-hair';\n                    }\n                    this.upperCanvas.style.cursor = 'default';\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.setCursorForZoomState = function (obj, ratio, isMouseMove) {\n        var tempObj = extend({}, obj, {}, true);\n        tempObj.activePoint.startX = (tempObj.activePoint.startX / ratio.width) * this.factor;\n        tempObj.activePoint.startY = (tempObj.activePoint.startY / ratio.width) * this.factor;\n        tempObj.activePoint.endX = (tempObj.activePoint.endX / ratio.width) * this.factor;\n        tempObj.activePoint.endY = (tempObj.activePoint.endY / ratio.width) * this.factor;\n        tempObj.activePoint.width = tempObj.activePoint.endX - tempObj.activePoint.startX;\n        tempObj.activePoint.height = tempObj.activePoint.endY - tempObj.activePoint.startY;\n        this.updateActiveObject(ratio, tempObj.activePoint, tempObj, isMouseMove);\n        tempObj.topLeftCircle.radius = (tempObj.topLeftCircle.radius / ratio.width) * this.factor;\n        return tempObj;\n    };\n    ImageEditor.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    ImageEditor.prototype.toSVGImg = function (fileName) {\n        var dataUrl = this.lowerCanvas.toDataURL();\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', this.lowerCanvas.style.maxWidth);\n        svg.setAttribute('height', this.lowerCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', this.lowerCanvas.height.toString());\n        img.setAttributeNS(null, 'width', this.lowerCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + this.lowerCanvas.width + \"\\\"\") + (\" height=\\\"\" + this.lowerCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    ImageEditor.prototype.toBlobFn = function (fileName, type) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        this.lowerCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.baseImg.src = blobUrl;\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n        }, 'image/png');\n    };\n    ImageEditor.prototype.addLetter = function (letter) {\n        if (this.textBox.style.display === 'none' && (this.currObjType.isText || this.activeObj.shape === 'text')) {\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory + this.tempKeyHistory).width\n                + this.activeObj.textSettings.fontSize * 0.5;\n            var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n            this.upperContext.fillText(this.keyHistory + this.tempKeyHistory, this.activeObj.activePoint.startX, this.activeObj.activePoint.startY +\n                this.activeObj.textSettings.fontSize);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.currObjType.isText = true;\n            this.setActivePoint(width, height);\n        }\n    };\n    ImageEditor.prototype.updateFontStyles = function (isTextBox) {\n        this.upperContext.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (this.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (this.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(this.textBox.style.fontSize) : this.activeObj.textSettings.fontSize;\n        var fontFamily = this.textBox.style.display === 'block' ? this.textBox.style.fontFamily : this.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    ImageEditor.prototype.updateInMemoryCanvas = function (operation) {\n        if (!this.disabled) {\n            var imgData = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.imgDataColl.push({ operation: operation, value: imgData });\n            this.inMemoryCanvas.width = imgData.width;\n            this.inMemoryCanvas.height = imgData.height;\n            this.inMemoryContext.putImageData(imgData, 0, 0);\n        }\n    };\n    ImageEditor.prototype.drawBaseImg = function () {\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n        this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n        this.inMemoryCanvas.width = this.lowerCanvas.width = this.imgDataColl[0].value.width;\n        this.inMemoryCanvas.height = this.lowerCanvas.height = this.imgDataColl[0].value.height;\n        this.inMemoryContext.putImageData(this.imgDataColl[0].value, 0, 0);\n        var maxDimension = this.calcMaxDimension(this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n        this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n        this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n        this.lowerCanvas.style.left = this.upperCanvas.style.left = (this.element.clientWidth - maxDimension.width) / 2 + 1 + 'px';\n        this.lowerCanvas.style.top = this.upperCanvas.style.top = (this.element.clientHeight - this.toolbarHeight - maxDimension.height) / 2 + 1 + 'px';\n        this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n    };\n    ImageEditor.prototype.calcPrevRatio = function () {\n        var oldWidthRatio;\n        var oldHeightRatio;\n        var maxDimension;\n        if (this.degree === 0 || this.degree % 180 === 0) {\n            maxDimension = this.calcMaxDimension(this.baseImg.height, this.baseImg.width);\n            oldWidthRatio = this.baseImg.height / maxDimension.width;\n            oldHeightRatio = this.baseImg.width / maxDimension.height;\n        }\n        else {\n            maxDimension = this.calcMaxDimension(this.baseImg.width, this.baseImg.height);\n            oldWidthRatio = this.baseImg.width / maxDimension.width;\n            oldHeightRatio = this.baseImg.height / maxDimension.height;\n        }\n        return { width: oldWidthRatio, height: oldHeightRatio };\n    };\n    ImageEditor.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var height = this.activeObj.textSettings.fontSize;\n        var lineHeight = ((height * rows.length) - (this.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        var yPoint = (this.activeObj.textSettings.fontSize * 0.85) + lineHeight;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (this.activeObj.textSettings.fontSize * 0.85);\n                }\n                yPoint += this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.15;\n            }\n            canvasDraw.fillText(text, startX + this.activeObj.textSettings.fontSize * 0.15, startY +\n                yPoint + (i > 0 ? this.activeObj.textSettings.fontSize * 0.25 : -this.activeObj.textSettings.fontSize * 0.35));\n        }\n    };\n    ImageEditor.prototype.rotateText = function (canvasDraw) {\n        var startX = this.activeObj.activePoint.startX;\n        var startY = this.activeObj.activePoint.startY;\n        var degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (degree % 360 === 0 && (this.degree !== -360 || this.currFlipState === '')) {\n            startX = this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.15;\n            startY = this.activeObj.activePoint.startY + (this.activeObj.activePoint.endY - this.activeObj.activePoint.startY);\n            var rows = this.activeObj.keyHistory.split('\\n');\n            for (var i = 0; i < rows.length; i++) {\n                startY = this.activeObj.activePoint.startY + (i * this.activeObj.textSettings.fontSize +\n                    this.activeObj.textSettings.fontSize * 0.25);\n                canvasDraw.fillText(rows[i], startX, startY);\n            }\n        }\n        else if (degree % 90 === 0 && degree % 180 !== 0) {\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            canvasDraw.translate(-this.lowerCanvas.height / 2, -this.lowerCanvas.width / 2);\n            if (degree % 90 === 0 && degree % 270 !== 0) {\n                startY = (this.lowerCanvas.width - this.activeObj.activePoint.endX) + this.activeObj.textSettings.fontSize * 0.4;\n                startX = this.activeObj.activePoint.startY;\n            }\n            else if (degree % 270 === 0) {\n                startX = this.lowerCanvas.height - this.activeObj.activePoint.endY;\n                startY = this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.4;\n            }\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(this.lowerCanvas.height / 2, this.lowerCanvas.width / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        }\n        else {\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            startX = this.lowerCanvas.width - this.activeObj.activePoint.endX;\n            startY = (this.lowerCanvas.height - this.activeObj.activePoint.endY) + this.activeObj.textSettings.fontSize * 0.4;\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        }\n        if (this.degree === 360 || this.degree === -360) {\n            this.degree = 0;\n        }\n    };\n    ImageEditor.prototype.redrawSelection = function () {\n        var ratio = this.calcRatio();\n        this.activeObj.activePoint.startX = 0;\n        this.activeObj.activePoint.startY = 0;\n        this.activeObj.activePoint.endX = this.lowerCanvas.width;\n        this.activeObj.activePoint.endY = this.lowerCanvas.height;\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        this.updateActiveObject(ratio, this.activeObj.activePoint, this.activeObj);\n        this.drawObject('duplicate', this.activeObj);\n    };\n    ImageEditor.prototype.redrawObj = function (degree) {\n        if (this.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical') {\n                this.updateCurrentActiveObjPoint(degree);\n            }\n            else if (degree === 90 || degree === -90) {\n                this.updateCurrentActiveObjPoint(degree);\n                for (var i = 0; i < this.objColl.length; i++) {\n                    this.apply(this.objColl[i].shape, this.objColl[i]);\n                }\n            }\n            else {\n                this.updateCurrentActiveObjPoint('zoom');\n                for (var i = 0; i < this.objColl.length; i++) {\n                    this.apply(this.objColl[i].shape, this.objColl[i]);\n                }\n            }\n        }\n        else if (this.objColl.length === 0 && (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical')) {\n            if (this.activeObj.horTopLine !== undefined && (this.activeObj.shape === undefined)) {\n                this.redrawSelection();\n            }\n            else if (this.activeObj.horTopLine !== undefined && this.activeObj.shape !== undefined) {\n                var splitWords = this.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    this.select(splitWords[1]);\n                }\n            }\n        }\n        else if ((degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical')) {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.select(splitWords[1]);\n            }\n            else {\n                this.redrawSelection();\n            }\n        }\n    };\n    ImageEditor.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var oldRatio = this.calcPrevRatio();\n        var ratio = this.calcRatio();\n        var currActObjIndex;\n        for (var index = 0; index < this.objColl.length; index++) {\n            if (this.activeObj.shape === this.objColl[index].shape &&\n                this.activeObj.activePoint.startX === this.objColl[index].activePoint.startX &&\n                this.activeObj.activePoint.startY === this.objColl[index].activePoint.startY &&\n                this.activeObj.activePoint.endX === this.objColl[index].activePoint.endX &&\n                this.activeObj.activePoint.endY === this.objColl[index].activePoint.endY &&\n                this.activeObj.currIndex === this.objColl[index].currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].activePoint.startX <= this.lowerCanvas.width / 2) {\n                        this.objColl[i].activePoint.startX = this.lowerCanvas.width / 2 + ((this.lowerCanvas.width / 2) -\n                            this.objColl[i].activePoint.endX);\n                        this.objColl[i].activePoint.endX = this.objColl[i].activePoint.startX + this.objColl[i].activePoint.width;\n                        this.updateActiveObject(ratio, this.objColl[i].activePoint, this.objColl[i]);\n                    }\n                    else if (this.objColl[i].activePoint.startX >= this.lowerCanvas.width / 2) {\n                        this.objColl[i].activePoint.startX = this.lowerCanvas.width - this.objColl[i].activePoint.endX;\n                        this.objColl[i].activePoint.endX = this.objColl[i].activePoint.startX + this.objColl[i].activePoint.width;\n                        this.updateActiveObject(ratio, this.objColl[i].activePoint, this.objColl[i]);\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].activePoint.startY <= this.lowerCanvas.height / 2) {\n                        this.objColl[i].activePoint.startY = this.lowerCanvas.height / 2 + ((this.lowerCanvas.height / 2) -\n                            this.objColl[i].activePoint.endY);\n                        this.objColl[i].activePoint.endY = this.objColl[i].activePoint.startY + this.objColl[i].activePoint.height;\n                        this.updateActiveObject(ratio, this.objColl[i].activePoint, this.objColl[i]);\n                    }\n                    else if (this.objColl[i].activePoint.startY >= this.lowerCanvas.height / 2) {\n                        this.objColl[i].activePoint.startY = this.lowerCanvas.height - this.objColl[i].activePoint.endY;\n                        this.objColl[i].activePoint.endY = this.objColl[i].activePoint.startY + this.objColl[i].activePoint.height;\n                        this.updateActiveObject(ratio, this.objColl[i].activePoint, this.objColl[i]);\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                this.activeObj = extend({}, this.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90 || degree === -90) {\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].activePoint.startX /= oldRatio.width;\n                this.objColl[i].activePoint.startY /= oldRatio.height;\n                this.objColl[i].activePoint.endX /= oldRatio.width;\n                this.objColl[i].activePoint.endY /= oldRatio.height;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endX - this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endY - this.objColl[i].activePoint.startY;\n                this.objColl[i].strokeSettings.strokeWidth /= (oldRatio.width / this.factor);\n                this.calcCurrPoints(degree, this.objColl[i]);\n                this.objColl[i].activePoint.endX = this.objColl[i].activePoint.startX + this.objColl[i].activePoint.width;\n                this.objColl[i].activePoint.endY = this.objColl[i].activePoint.startY + this.objColl[i].activePoint.height;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX - this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY - this.objColl[i].activePoint.startY;\n            }\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].activePoint.startX *= oldRatio.width;\n                this.objColl[i].activePoint.startY *= oldRatio.height;\n                this.objColl[i].activePoint.endX *= oldRatio.width;\n                this.objColl[i].activePoint.endY *= oldRatio.height;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX - this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY - this.objColl[i].activePoint.startY;\n                this.objColl[i].strokeSettings.strokeWidth *= ratio.width;\n            }\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.updateActiveObject(ratio, this.objColl[i].activePoint, this.objColl[i]);\n            }\n        }\n        else if (degree === 'zoom') {\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].activePoint.startX /= ratio.width;\n                this.objColl[i].activePoint.startY /= ratio.height;\n                this.objColl[i].activePoint.endX /= ratio.width;\n                this.objColl[i].activePoint.endY /= ratio.height;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endX - this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endY - this.objColl[i].activePoint.startY;\n                this.objColl[i].activePoint.startX *= ratio.width;\n                this.objColl[i].activePoint.startY *= ratio.height;\n                this.objColl[i].activePoint.endX *= ratio.width;\n                this.objColl[i].activePoint.endY *= ratio.height;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX - this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY - this.objColl[i].activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.calcCurrPoints = function (degree, obj) {\n        var oldRatio = this.calcPrevRatio();\n        if (degree > 0) {\n            var x = obj.activePoint.startX;\n            obj.activePoint.startX = (this.lowerCanvas.width / oldRatio.width) - (obj.activePoint.startY + obj.activePoint.width);\n            obj.activePoint.startY = x;\n        }\n        else {\n            var y = obj.activePoint.startY;\n            obj.activePoint.startY = (this.lowerCanvas.height / oldRatio.height) - (obj.activePoint.startX + obj.activePoint.height);\n            obj.activePoint.startX = y;\n        }\n    };\n    ImageEditor.prototype.redrawShape = function (obj) {\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(this.objColl[i])) {\n                this.objColl.splice(i, 1);\n                break;\n            }\n        }\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.drawObject('duplicate', obj);\n    };\n    ImageEditor.prototype.applyActObj = function () {\n        var isActObj = false;\n        if (this.activeObj.shape !== undefined && this.activeObj.shape === 'text' && this.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && this.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0 && !isCropSelection) {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (JSON.stringify(this.activeObj) === JSON.stringify(this.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(this.activeObj.currIndex)) {\n                        this.activeObj.currIndex = 'shape_' + (this.objColl.length + 1);\n                    }\n                    var splitWords_2 = this.activeObj.currIndex.split('_');\n                    var tempObjColl = this.objColl.splice(0, parseInt(splitWords_2[1], 10) - 1);\n                    tempObjColl.push(extend({}, this.activeObj, {}, true));\n                    for (var i = 0; i < this.objColl.length; i++) {\n                        tempObjColl.push(this.objColl[i]);\n                    }\n                    this.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                    this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n                    for (var i = 0; i < this.objColl.length; i++) {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                    this.activeObj.flippedText = false;\n                    this.currObjType.shape = '';\n                    this.refreshActiveObj();\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.apply = function (shape, obj, canvas) {\n        if (!this.disabled) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var proxy_1 = this;\n            if ((this.togglePen) && !this.currObjType.isCustomCrop) {\n                // eslint-disable-next-line @typescript-eslint/tslint/config\n                this.upperCanvas.toBlob(function (blob) {\n                    showSpinner(proxy_1.element);\n                    proxy_1.element.style.opacity = '0.5';\n                    proxy_1.lowerContext.clearRect(0, 0, proxy_1.lowerCanvas.width, proxy_1.lowerCanvas.height);\n                    proxy_1.lowerContext.drawImage(proxy_1.inMemoryCanvas, 0, 0);\n                    proxy_1.baseImg.src = URL.createObjectURL(blob);\n                    proxy_1.upperContext.clearRect(0, 0, proxy_1.upperCanvas.width, proxy_1.upperCanvas.height);\n                    proxy_1.togglePen = false;\n                    proxy_1.upperCanvas.style.cursor = 'default';\n                    for (var i = 0, len = proxy_1.objColl.length; i < len; i++) {\n                        proxy_1.apply(proxy_1.objColl[i].shape, proxy_1.objColl[i], 'duplicate');\n                    }\n                    proxy_1.togglePen = true;\n                }, 'image/png');\n                this.isUndoRedo = false;\n                this.degree = 0;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                this.currObjType.shape = shape !== undefined ? shape : this.currObjType.shape;\n                if (this.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    this.drawObject(canvas, obj);\n                    this.activeObj.shape = this.currObjType.shape.toLowerCase();\n                    if (!shape && this.currObjType.shape !== '' && !this.currObjType.isCustomCrop) {\n                        this.objColl.push(extend({}, this.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n                this.isUndoRedo = false;\n            }\n        }\n    };\n    ImageEditor.prototype.setCenterPoints = function (text, width, height) {\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = this.activeObj.activePoint.width;\n            renderHeight = this.activeObj.activePoint.height;\n        }\n        if (this.factor === 1) {\n            this.activeObj.activePoint.startX = (this.lowerCanvas.width / 2) - renderWidth / 2;\n            this.activeObj.activePoint.startY = (this.lowerCanvas.height / 2) - renderHeight / 2;\n            this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) + renderWidth / 2;\n            this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) + renderHeight / 2;\n        }\n        else {\n            var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n            var visibleWidth = endPoint.x - this.pannStart.startX;\n            var visibleHeight = endPoint.y - this.pannStart.startY;\n            var centerX = (this.dragPoint.startX = visibleWidth / 2) + this.pannStart.startX;\n            var centerY = this.dragPoint.startY = visibleHeight / 2 + this.pannStart.startY;\n            this.activeObj.activePoint.startX = centerX - (renderWidth / 2);\n            this.activeObj.activePoint.startY = centerY - (renderHeight / 2);\n            this.activeObj.activePoint.endX = centerX + (renderWidth / 2);\n            this.activeObj.activePoint.endY = centerY + (renderHeight / 2);\n        }\n        if (text && width && height) {\n            this.textStartPoints.x = this.activeObj.activePoint.startX;\n            this.textStartPoints.y = this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            var ratio = this.calcRatio();\n            this.redrawActObj();\n            this.togglePen = false;\n            this.keyHistory = '';\n            this.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            this.currObjType.shape = type;\n            if (this.currObjType.shape.toLowerCase() !== 'freehanddraw' && this.currObjType.shape.toLowerCase() !== '') {\n                this.activeObj.shape = this.currObjType.shape.toLowerCase();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                    this.activeObj.strokeSettings = this.strokeSettings;\n                }\n                this.activeObj.strokeSettings.strokeWidth = strokeWidth ? strokeWidth : this.activeObj.strokeSettings.strokeWidth;\n                this.activeObj.strokeSettings.strokeColor = strokeColor ? strokeColor : this.activeObj.strokeSettings.strokeColor;\n                this.activeObj.strokeSettings.fillColor = fillColor ? fillColor : this.activeObj.strokeSettings.fillColor;\n                var tempWidth = 100 / this.factor;\n                var tempHeight = 100 / this.factor;\n                this.activeObj.activePoint.width = tempWidth * ratio.width;\n                this.activeObj.activePoint.height = tempHeight * ratio.height;\n                if (this.currObjType.shape.toLowerCase() === 'line') {\n                    this.activeObj.lineDraw = 'horizontal';\n                    this.activeObj.activePoint.height /= 2;\n                }\n                else if (this.currObjType.shape.toLowerCase() === 'rectangle') {\n                    this.activeObj.activePoint.width += this.activeObj.activePoint.width / 2;\n                }\n                if (this.currObjType.shape.toLowerCase() === 'ellipse' && width) {\n                    this.activeObj.activePoint.width = 2 * width;\n                    this.activeObj.activePoint.height = 2 * height;\n                }\n                if (width && height) {\n                    this.activeObj.activePoint.width = width;\n                    this.activeObj.activePoint.height = height;\n                }\n                if (start !== undefined) {\n                    this.activeObj.activePoint.startX = start.x;\n                    this.activeObj.activePoint.startY = start.y;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                }\n                else {\n                    this.setCenterPoints();\n                }\n                this.currObjType.isDragging = this.currObjType.isCustomCrop = false;\n                this.activeObj.shapeDegree = this.degree;\n                this.activeObj.flipObjColl = [];\n                this.drawObject('duplicate');\n                this.refreshToolbar('shapes');\n            }\n        }\n    };\n    ImageEditor.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            var ratio = this.calcRatio();\n            this.togglePen = false;\n            this.redrawActObj();\n            this.keyHistory = '';\n            this.refreshActiveObj();\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: this.activeObj, currentShapeSettings: this.activeObj };\n            this.trigger('shapeChanging', shapeChangingArgs);\n            this.currObjType.isCustomCrop = false;\n            this.currObjType.isText = this.currObjType.isInitialText = true;\n            this.upperCanvas.style.display = 'block';\n            this.currObjType.shape = this.activeObj.shape = 'text';\n            if (isNullOrUndefined(this.activeObj.textSettings)) {\n                this.activeObj.textSettings = this.textSettings;\n            }\n            if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                this.activeObj.strokeSettings = this.strokeSettings;\n            }\n            this.activeObj.strokeSettings.strokeColor = strokeColor ? strokeColor : this.activeObj.strokeSettings.strokeColor;\n            this.activeObj.textSettings.text = text ? text : this.activeObj.textSettings.text;\n            this.activeObj.textSettings.fontFamily = fontFamily ? fontFamily : this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.text = text ? text : this.activeObj.textSettings.text;\n            this.activeObj.textSettings.fontFamily = fontFamily ? fontFamily : this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontSize = fontSize ? fontSize : this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.bold = bold ? bold : this.activeObj.textSettings.bold;\n            this.activeObj.textSettings.italic = italic ? italic : this.activeObj.textSettings.italic;\n            if (isNullOrUndefined(this.activeObj.textSettings.fontSize)) {\n                if (this.lowerCanvas.width > this.lowerCanvas.height) {\n                    this.activeObj.textSettings.fontSize = Math.floor((this.lowerCanvas.width / 20));\n                }\n                else {\n                    this.activeObj.textSettings.fontSize = Math.floor((this.lowerCanvas.height / 20));\n                }\n                if (this.activeObj.textSettings.fontSize < 20 * (ratio.width + ratio.height)) {\n                    this.activeObj.textSettings.fontSize = 20 * (ratio.width + ratio.height);\n                }\n            }\n            this.activeObj.shapeDegree = this.degree;\n            this.activeObj.shapeFlip = this.currFlipState;\n            this.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.activeObj.textSettings.text).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.startY = y;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + width;\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            this.addLetter(this.activeObj.textSettings.text);\n            this.refreshToolbar('text');\n        }\n    };\n    ImageEditor.prototype.drawPen = function (context) {\n        var ratio = this.calcRatio();\n        context = context ? context : this.upperContext;\n        this.upperCanvas.style.display = 'block';\n        this.canvasRatio = this.calcRatio();\n        if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n            this.activeObj.strokeSettings = this.strokeSettings;\n        }\n        if (isNullOrUndefined(this.activeObj.strokeSettings.strokeWidth)) {\n            this.activeObj.strokeSettings.strokeWidth = (ratio.width + ratio.height) * 0.4;\n        }\n        context.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        context.lineWidth = 2 * (this.activeObj.strokeSettings.strokeWidth) / this.factor;\n        context.beginPath();\n        context.moveTo(this.prevX, this.prevY);\n        context.lineTo(this.currX, this.currY);\n        context.stroke();\n        context.closePath();\n    };\n    ImageEditor.prototype.getObjDetails = function (obj) {\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = obj.shape;\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        if (obj.shape === 'rectangle') {\n            shapeDetails.width = obj.activePoint.width;\n            shapeDetails.height = obj.activePoint.height;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.fillColor = obj.strokeSettings.fillColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'ellipse') {\n            shapeDetails.radius = obj.activePoint.width / 2;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.fillColor = obj.strokeSettings.fillColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'line') {\n            shapeDetails.length = obj.activePoint.width;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'text') {\n            shapeDetails.text = obj.keyHistory;\n            shapeDetails.fontSize = obj.textSettings.fontSize;\n            shapeDetails.color = obj.strokeSettings.strokeColor;\n            shapeDetails.fontStyle = [];\n            if (obj.textSettings.bold) {\n                shapeDetails.fontStyle.push('bold');\n            }\n            if (obj.textSettings.italic) {\n                shapeDetails.fontStyle.push('italic');\n            }\n        }\n        return shapeDetails;\n    };\n    ImageEditor.prototype.isPointsInRange = function (x, y) {\n        var inRange = false;\n        if (this.factor === 1) {\n            if (x >= 0 && y >= 0 && x <= this.lowerCanvas.width && y <= this.lowerCanvas.width) {\n                inRange = true;\n            }\n        }\n        else {\n            var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n            if (x >= this.pannStart.startX && y >= this.pannStart.startY && x <= endPoint.x && y <= endPoint.y) {\n                inRange = true;\n            }\n        }\n        return inRange;\n    };\n    /**\n     * Clear a current selection.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function () {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            this.togglePen = false;\n            this.refreshActiveObj();\n            this.dragElement = '';\n            this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n            this.currObjType.shape = '';\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.currObjType.isActiveObj = true;\n            this.currObjType.isCustomCrop = false;\n            this.upperCanvas.style.cursor = 'default';\n        }\n    };\n    /**\n     * Crops an image based on the selection.\n     * The selection can be done through programmatically using the select method or through UI interactions.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.crop = function () {\n        var isCrop = false;\n        var splitWords;\n        var transitionArgs = { startPoint: { x: this.activeObj.activePoint.startX, y: this.activeObj.activePoint.startY }, endPoint: { x: this.activeObj.activePoint.endX, y: this.activeObj.activePoint.endY } };\n        this.trigger('cropping', transitionArgs);\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (!this.disabled && this.activeObj.horTopLine !== undefined && (this.currObjType.isCustomCrop || splitWords[0] === 'crop')) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var proxy_2 = this;\n            isCrop = true;\n            this.upperCanvas.style.display = 'none';\n            var widthRatio = void 0;\n            var heightRatio = void 0;\n            var imgData = void 0;\n            var zoomedRotate = false;\n            if (this.factor === 1) {\n                imgData = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                widthRatio = this.lowerCanvas.width / parseInt(this.lowerCanvas.style.maxWidth, 10);\n                heightRatio = this.lowerCanvas.height / parseInt(this.lowerCanvas.style.maxHeight, 10);\n            }\n            else {\n                this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n                imgData = this.imgDataColl[0].value;\n                widthRatio = this.lowerCanvas.width / parseInt(this.lowerCanvas.style.maxWidth, 10);\n                heightRatio = this.lowerCanvas.height / parseInt(this.lowerCanvas.style.maxHeight, 10);\n                if (this.degree !== 0 && this.flipState !== '') {\n                    this.degree = 0;\n                }\n                if (this.degree !== 0) {\n                    zoomedRotate = true;\n                    this.lowerCanvas.width = this.upperCanvas.width = this.baseImg.width;\n                    this.lowerCanvas.height = this.upperCanvas.height = this.baseImg.height;\n                    var tempObj = extend({}, this.activeObj, {}, true);\n                    this.factor = 1;\n                    this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n                    this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                    if (this.degree === 180) {\n                        this.updateInMemoryContext(imgData);\n                    }\n                    var maxDimension = this.calcMaxDimension(tempObj.activePoint.width, tempObj.activePoint.height);\n                    this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n                    this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n                    this.lowerCanvas.width = this.upperCanvas.width = maxDimension.width * widthRatio;\n                    this.lowerCanvas.height = this.upperCanvas.height = maxDimension.height * heightRatio;\n                    if (this.degree !== 180) {\n                        this.updateInMemoryContext(imgData);\n                    }\n                    this.degree = 0;\n                    this.lowerContext.drawImage(this.inMemoryCanvas, tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                }\n                if (this.flipState !== '') {\n                    zoomedRotate = true;\n                    var tempObj = extend({}, this.activeObj, {}, true);\n                    this.flipState = '';\n                    this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n                    this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                    this.updateInMemoryContext(imgData);\n                    var maxDimension = this.calcMaxDimension(tempObj.activePoint.width, tempObj.activePoint.height);\n                    this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n                    this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n                    this.lowerCanvas.width = this.upperCanvas.width = maxDimension.width * widthRatio;\n                    this.lowerCanvas.height = this.upperCanvas.height = maxDimension.height * heightRatio;\n                    this.lowerContext.drawImage(this.inMemoryCanvas, tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                }\n            }\n            if (!zoomedRotate) {\n                this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.inMemoryCanvas.width = imgData.width;\n                this.inMemoryCanvas.height = imgData.height;\n                this.inMemoryContext.putImageData(imgData, 0, 0);\n                this.updateInMemoryContext(imgData);\n                var maxDimension = this.calcMaxDimension(this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n                this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = maxDimension.width + 'px';\n                this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = maxDimension.height + 'px';\n                this.lowerCanvas.width = this.upperCanvas.width = maxDimension.width * widthRatio;\n                this.lowerCanvas.height = this.upperCanvas.height = maxDimension.height * heightRatio;\n                var cssObj = window.getComputedStyle(this.lowerCanvas);\n                this.lowerCanvas.style.left = this.upperCanvas.style.left =\n                    ((this.element.clientWidth - parseInt(cssObj.width, 10) - 18) / 2) + 1 + 'px';\n                this.lowerCanvas.style.top = this.upperCanvas.style.top = ((this.element.clientHeight - this.toolbarHeight\n                    - parseInt(cssObj.height, 10)) / 2) + 1 + 'px';\n                this.lowerContext.drawImage(this.inMemoryCanvas, this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            }\n            if (this.activeObj.shape === 'crop-circle') {\n                var imgData_1 = this.lowerContext.getImageData(0, 0, this.baseImg.width, this.baseImg.height);\n                this.inMemoryCanvas.width = imgData_1.width;\n                this.inMemoryCanvas.height = imgData_1.height;\n                this.inMemoryContext.putImageData(imgData_1, 0, 0);\n                this.lowerContext.save();\n                this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0, this.baseImg.width, this.baseImg.height);\n                this.lowerContext.globalCompositeOperation = 'destination-in';\n                this.lowerContext.beginPath();\n                this.lowerContext.arc(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2, this.lowerCanvas.width / 2, 0, Math.PI * 2);\n                this.lowerContext.closePath();\n                this.lowerContext.fill();\n                this.lowerContext.restore();\n                this.currObjType.isActiveObj = true;\n            }\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n            var blobUrl_1;\n            var data_1;\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            this.lowerCanvas.toBlob(function (blob) {\n                blobUrl_1 = URL.createObjectURL(blob);\n                proxy_2.isUndoRedo = false;\n                proxy_2.baseImg.src = blobUrl_1;\n                data_1 = proxy_2.lowerContext.getImageData(0, 0, proxy_2.lowerCanvas.width, proxy_2.lowerCanvas.height);\n                proxy_2.imgDataColl = [];\n                if (!proxy_2.isUndoRedo) {\n                    proxy_2.updateUndoRedoColl('crop', data_1, proxy_2.objColl);\n                }\n                proxy_2.isUndoRedo = false;\n            }, 'image/png');\n            this.objColl = [];\n            this.refreshActiveObj();\n            this.degree = 0;\n            this.flipState = '';\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.globalAlpha = 0;\n            this.lowerContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.factor = 1;\n        }\n        return isCrop;\n    };\n    ImageEditor.prototype.updateInMemoryContext = function (imgData) {\n        this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n        var temp = extend({}, this.activeObj, {}, true);\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.apply(this.objColl[i].shape, this.objColl[i]);\n        }\n        this.activeObj = temp;\n        imgData = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.inMemoryCanvas.width = imgData.width;\n        this.inMemoryCanvas.height = imgData.height;\n        this.inMemoryContext.putImageData(imgData, 0, 0);\n    };\n    /**\n     * Flips an image by horizontally or vertically.\n     *\n     * @param {Direction } direction - Specifies the direction to flip the image.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            if (this.factor !== 1) {\n                this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.factor = 1;\n                this.refreshToolbar('main');\n            }\n            var transitionArgs = { direction: direction };\n            this.trigger('flipping', transitionArgs);\n            this.lastAction = 'flip';\n            this.flipMethod = true;\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (!isNullOrUndefined(this.activeObj.activePoint)) {\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = this.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                }\n            }\n            this.redrawActObj();\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            if (direction.toLowerCase() === 'horizontal') {\n                this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n                this.lowerContext.scale(-1, 1);\n                this.upperContext.translate(this.upperContext.canvas.width, 0);\n                this.upperContext.scale(-1, 1);\n                this.flipDirection = 'horizontal';\n                if (this.flipState === '' || this.flipState.toLowerCase() === 'vertical') {\n                    this.flipState = 'horizontal';\n                }\n                if (this.currFlipState.toLowerCase() === 'horizontal') {\n                    this.currFlipState = '';\n                }\n                else {\n                    this.currFlipState = 'horizontal';\n                }\n            }\n            else {\n                this.lowerContext.translate(0, this.lowerContext.canvas.height);\n                this.lowerContext.scale(1, -1);\n                this.upperContext.translate(0, this.upperContext.canvas.height);\n                this.upperContext.scale(1, -1);\n                this.flipDirection = 'vertical';\n                if (this.flipState.toLowerCase() === '' || this.flipState.toLowerCase() === 'horizontal') {\n                    this.flipState = 'vertical';\n                }\n                if (this.currFlipState.toLowerCase() === 'vertical') {\n                    this.currFlipState = '';\n                }\n                else {\n                    this.currFlipState = 'vertical';\n                }\n            }\n            this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n            this.currImgData = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryCanvas.width = this.currImgData.width;\n            this.inMemoryCanvas.height = this.currImgData.height;\n            this.inMemoryContext.putImageData(this.currImgData, 0, 0);\n            if (this.flipState.toLowerCase() === 'horizontal') {\n                for (var i = 0, len = this.objColl.length; i < len; i++) {\n                    this.objColl[i].flippedText = false;\n                    if (this.objColl[i].shapeFlip !== '' && this.objColl[i].shapeFlip === this.currFlipState) {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                    else {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                }\n                this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n                this.lowerContext.scale(-1, 1);\n                this.upperContext.translate(this.upperContext.canvas.width, 0);\n                this.upperContext.scale(-1, 1);\n                this.flipDirection = '';\n            }\n            else if (this.flipState.toLowerCase() === 'vertical') {\n                for (var i = 0, len = this.objColl.length; i < len; i++) {\n                    this.objColl[i].flippedText = false;\n                    if (this.objColl[i].shapeFlip !== '' && this.objColl[i].shapeFlip === this.currFlipState) {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                    else {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                }\n                this.lowerContext.translate(0, this.lowerContext.canvas.height);\n                this.lowerContext.scale(1, -1);\n                this.upperContext.translate(0, this.upperContext.canvas.height);\n                this.upperContext.scale(1, -1);\n                this.flipDirection = '';\n            }\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                if (this.objColl[i].flipObjColl.length === 0) {\n                    this.objColl[i].flipObjColl.push(direction);\n                }\n                else if (this.objColl[i].flipObjColl[this.objColl[i].flipObjColl.length - 1] === direction) {\n                    this.objColl[i].flipObjColl.pop();\n                }\n                else {\n                    this.objColl[i].flipObjColl.push(direction);\n                }\n            }\n            this.redrawObj(direction.toLowerCase());\n            if (this.flipState === '') {\n                for (var i = 0, len = this.objColl.length; i < len; i++) {\n                    this.apply(this.objColl[i].shape, this.objColl[i]);\n                }\n            }\n            this.refreshActiveObj();\n            if (!this.isUndoRedo) {\n                this.updateUndoRedoColl('flip', direction, this.objColl);\n            }\n            this.isUndoRedo = this.flipMethod = false;\n            if (!isNullOrUndefined(activeObjShape)) {\n                if (activeObjShape === 'custom') {\n                    this.activeObj.activePoint = { startX: 0, startY: 0, endX: this.lowerCanvas.width,\n                        endY: this.lowerCanvas.height, width: this.lowerCanvas.width, height: this.lowerCanvas.height };\n                    this.updateActiveObject(this.calcRatio(), this.activeObj.activePoint, this.activeObj);\n                    this.drawObject('duplicate', this.activeObj);\n                }\n                else {\n                    this.select(activeObjShape);\n                }\n            }\n        }\n    };\n    /**\n     * Return an image as ImageData.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function () {\n        var data = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        return data;\n    };\n    /**\n     *  Load/opens an image for editing within an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the Image or image data.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data) {\n        if (!this.disabled) {\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n            var toolbar_10 = document.querySelector('#' + this.element.id + '_currPos');\n            if (toolbar_10) {\n                toolbar_10.style.display = 'none';\n            }\n            if (this.defToolbarItems.length === 0 &&\n                (isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n                this.toolbarHeight = 0;\n            }\n            this.update();\n            var type = typeof (data);\n            if (type === 'string') {\n                this.imageOnLoad(data);\n            }\n            else {\n                this.lowerCanvas = document.querySelector('#' + this.element.id + '_lowerCanvas');\n                this.upperCanvas = document.querySelector('#' + this.element.id + '_upperCanvas');\n                this.lowerContext = this.lowerCanvas.getContext('2d');\n                this.upperContext = this.upperCanvas.getContext('2d');\n                this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                this.inMemoryCanvas.width = this.baseImg.width = data.width;\n                this.inMemoryCanvas.height = this.baseImg.height = data.height;\n                this.inMemoryContext.putImageData(data, 0, 0);\n                this.imgDataColl.push({ operation: 'open', value: data });\n                this.lowerCanvas.width = this.upperCanvas.width = data.width;\n                this.lowerCanvas.height = this.upperCanvas.height = data.height;\n                this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.updateCanvas();\n                hideSpinner(this.element);\n                this.element.style.opacity = '1';\n            }\n        }\n    };\n    /**\n     * Reset all the changesand revert to original image.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        if (!this.disabled) {\n            this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n            this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n            this.upperContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n            this.upperContext.clearRect(0, 0, this.inMemoryCanvas.height, this.inMemoryCanvas.width);\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n            if (this.imgDataColl.length > 0) {\n                if (this.imgDataColl[0].operation === 'freehanddraw') {\n                    this.imgDataColl.splice(0, 1);\n                    this.imgDataColl.splice(1, 1);\n                }\n                this.inMemoryCanvas.width = this.imgDataColl[0].value.width;\n                this.inMemoryCanvas.height = this.imgDataColl[0].value.height;\n                this.inMemoryContext.putImageData(this.imgDataColl[0].value, 0, 0);\n                this.redrawImg();\n            }\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n            this.baseImg.src = this.baseImgSrc;\n            this.factor = 1;\n            this.refreshToolbar('main');\n            if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n            }\n            this.objColl = [];\n            this.imgDataColl = [];\n            this.degree = 0;\n            this.flipState = this.keyHistory = this.currFlipState = this.flipDirection = '';\n            this.upperCanvas.style.display = 'none';\n            this.upperCanvas.style.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.undoRedoColl = [];\n            this.dragCanvas = this.dragged = this.isUndoRedo = this.activeObj.flippedText = this.flipMethod = false;\n            this.currImgData = {};\n            this.pannStart = { startX: 0, startY: 0, width: 0, height: 0 };\n            this.pannEnd = { startX: 0, startY: 0, width: 0, height: 0 };\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.togglePan = this.togglePen = this.rotateMethod = false;\n            this.lastX = this.lastY = 0;\n            this.dragStart = { x: 0, y: 0 };\n            this.touchEndPoint = {};\n            this.prevX = this.currX = this.prevY = this.currY = 0;\n            this.lastAction = this.tempKeyHistory = '';\n            this.isBoldbtn = this.isItalicbtn = false;\n            this.currentToolbar = 'main';\n            this.textStartPoints = { x: 0, y: 0 };\n            this.fontSizeColl = this.penDrawColl = [];\n            this.textBox.value = this.textBox.textContent = '';\n            this.textBox.style.display = 'none';\n            this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.textSettings =\n                { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, bold: false, italic: false, underline: false };\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.penStrokeWidth = undefined;\n            this.tempTextSettings =\n                { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, bold: false, italic: false, underline: false };\n            this.refreshActiveObj();\n            this.timer = undefined;\n            this.isScreenOriented = false;\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false };\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var isRotate = false;\n        if (!this.disabled && this.imgDataColl.length > 0 && (degree % 90 === 0)) {\n            isRotate = true;\n            var transitionArgs = { degree: degree };\n            this.trigger('rotating', transitionArgs);\n            this.rotateMethod = true;\n            this.lastAction = 'rotate';\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (!isNullOrUndefined(this.activeObj.activePoint)) {\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = this.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                }\n            }\n            this.redrawActObj();\n            if (this.factor !== 1) {\n                this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.factor = 1;\n                this.refreshToolbar('main');\n            }\n            this.degree += degree;\n            if (this.degree === 360) {\n                this.degree = 0;\n            }\n            this.lowerContext.save();\n            this.setMaximumDimension(this.degree);\n            this.lowerContext.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            this.lowerContext.rotate(Math.PI / 180 * degree);\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = (this.element.clientWidth - parseInt(this.lowerCanvas.style.maxWidth, 10) - 18) / 2 + 1 + 'px';\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = (this.element.clientHeight - this.toolbarHeight - parseInt(this.lowerCanvas.style.maxHeight, 10)) / 2 + 1 + 'px';\n            this.lowerContext.drawImage(this.inMemoryCanvas, -this.lowerCanvas.height / 2, -this.lowerCanvas.width / 2);\n            this.lowerContext.rotate(Math.PI / 180 * -degree);\n            this.lowerContext.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n            this.lowerContext.restore();\n            this.currImgData = this.lowerContext.getImageData(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryCanvas.width = this.currImgData.width;\n            this.inMemoryCanvas.height = this.currImgData.height;\n            this.inMemoryContext.putImageData(this.currImgData, 0, 0);\n            this.redrawObj(degree);\n            if (!isNullOrUndefined(activeObjShape)) {\n                if (activeObjShape === 'custom') {\n                    var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                    this.activeObj.activePoint = { startX: this.pannStart.startX, startY: this.pannStart.startY, endX: endPoint.x,\n                        endY: endPoint.y, width: endPoint.x - this.pannStart.startX, height: endPoint.y - this.pannStart.startY };\n                    this.updateActiveObject(this.calcRatio(), this.activeObj.activePoint, this.activeObj);\n                    this.drawObject('duplicate', this.activeObj);\n                }\n                else {\n                    this.select(activeObjShape);\n                }\n                this.refreshToolbar('main', true, true);\n            }\n            this.factor = 1;\n            if (!this.isUndoRedo) {\n                this.updateUndoRedoColl('rotate', degree, this.objColl);\n            }\n            this.isUndoRedo = false;\n        }\n        this.rotateMethod = false;\n        return isRotate;\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName  Specifies a file name to be saved\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName) {\n        var _this = this;\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            if (this.togglePen) {\n                this.currObjType.isZoomed = true;\n                this.applyPenDraw();\n            }\n            this.applyActObj();\n            if (this.factor !== 1) {\n                this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.upperContext.setTransform(1, 0, 0, 1, 0, 0);\n                this.factor = 1;\n                this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n                for (var i = 0; i < this.objColl.length; i++) {\n                    this.apply(this.objColl[i].shape, this.objColl[i]);\n                    this.refreshActiveObj();\n                }\n            }\n            type = type ? type : 'Png';\n            this.redrawActObj();\n            var beforeSave = { cancel: false, fileName: 'ImageEditor', fileType: type };\n            var saved_1 = { fileName: 'ImageEditor', fileType: type };\n            this.trigger('beforeSave', beforeSave, function (observableSaveArgs) {\n                if (!observableSaveArgs.cancel) {\n                    fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n                    if (type.toLowerCase() === 'svg') {\n                        fileName = fileName || 'ImageEditor';\n                        _this.toSVGImg(fileName);\n                    }\n                    else if (type.toLowerCase() === 'jpeg') {\n                        fileName = fileName || 'ImageEditor';\n                        _this.toBlobFn(fileName, type.toLowerCase());\n                    }\n                    else {\n                        fileName = fileName || 'ImageEditor';\n                        _this.toBlobFn(fileName, type.toLowerCase());\n                    }\n                    _this.trigger('saved', saved_1);\n                    _this.refreshToolbar('main');\n                }\n            });\n        }\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX  Specifies the start x-coordinate point of the selection.\n     * @param {number} startY  Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     * @returns {void}.\n     *   ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     *   created : () => {\n     *     imageObj.select('16:9', 10, 10);\n     *  }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            var ratio = this.calcRatio();\n            var points = void 0;\n            this.redrawActObj();\n            this.refreshActiveObj();\n            this.keyHistory = '';\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.upperCanvas.style.display = 'block';\n            var cropShape = 'crop-' + type;\n            if (cropShape.toLowerCase() === 'crop-custom') {\n                if (this.currObjType.shape === '') {\n                    this.currObjType.isCustomCrop = true;\n                    this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.5)';\n                    this.upperContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                    this.upperCanvas.style.cursor = 'crosshair';\n                    if (Browser.isDevice) {\n                        var arcRadius = (7.5 * (ratio.width > ratio.height ? ratio.width : ratio.height)) / this.factor;\n                        var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                        this.activeObj.activePoint = { startX: this.pannStart.startX + arcRadius, startY: this.pannStart.startY + arcRadius,\n                            endX: endPoint.x - arcRadius, endY: endPoint.y - arcRadius };\n                        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                        this.updateActiveObject(this.calcRatio(), this.activeObj.activePoint, this.activeObj);\n                        this.drawObject('duplicate', this.activeObj);\n                        this.upperCanvas.style.cursor = 'default';\n                    }\n                }\n                if (startX && startY) {\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    this.currObjType.shape = this.activeObj.shape = cropShape.toLowerCase();\n                    this.activeObj.activePoint.startX = startX + ratio.width;\n                    this.activeObj.activePoint.startY = startY + ratio.height;\n                    this.activeObj.activePoint.endX = this.baseImg.width - (2 * ratio.width);\n                    this.activeObj.activePoint.endY = this.baseImg.height - (2 * ratio.height);\n                    this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                    this.drawObject('duplicate');\n                }\n            }\n            else if (cropShape.toLowerCase() === 'crop-canvas') {\n                this.upperCanvas.style.display = 'none';\n                this.dragCanvas = true;\n            }\n            else {\n                this.currObjType.isCustomCrop = false;\n                this.currObjType.shape = cropShape.toLowerCase();\n                if (width && height) {\n                    points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                        width: width, height: height };\n                }\n                else if (width && cropShape === 'crop-circle') {\n                    points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                        width: width, height: width };\n                }\n                this.activeObj.shape = cropShape.toLowerCase();\n                this.drawObject('duplicate', null, null, true, points);\n            }\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable freehand drawing.\n     *\n     *  @returns {void}.\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        if (value) {\n            this.togglePen = true;\n            this.upperCanvas.style.cursor = 'cross-hair';\n            this.drawPen();\n        }\n        else {\n            this.upperCanvas.style.cursor = 'default';\n            this.applyPenDraw();\n        }\n        this.refreshToolbar('pen');\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            if (value) {\n                this.togglePan = true;\n                this.redrawActObj();\n                this.dragCanvas = true;\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n            }\n            else {\n                this.dragCanvas = this.togglePan = false;\n                this.refreshActiveObj();\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'default';\n            }\n        }\n    };\n    /**\n     * Increase / Decrease the magnification of an image.\n     *\n     * @param {boolean} value - Specifies a value to be zoomed on the image.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.zoom = function (value) {\n        if (!this.disabled && this.imgDataColl.length > 0) {\n            if ((this.factor === 1 && value < 0) || (this.factor > 8 && value > 0)) {\n                return;\n            }\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (!isNullOrUndefined(this.activeObj.activePoint)) {\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = this.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                }\n            }\n            this.redrawActObj();\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperCanvas.style.cursor = 'default';\n            var zoomState = void 0;\n            if (value === 3.75 || value === 1) {\n                zoomState = 0.1;\n            }\n            else if (value === -3.75) {\n                zoomState = -0.1;\n            }\n            else {\n                zoomState = value;\n            }\n            if (this.degree !== 0) {\n                this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n                this.inMemoryCanvas.width = this.currImgData.width;\n                this.inMemoryCanvas.height = this.currImgData.height;\n                this.inMemoryContext.putImageData(this.currImgData, 0, 0);\n            }\n            if (value === 0.1 || value === -0.1) {\n                this.lastX = this.lowerCanvas.width / 2;\n                this.lastY = this.lowerCanvas.height / 2;\n            }\n            if (value > 0) {\n                this.zoomImg(3.75);\n            }\n            else {\n                this.zoomImg(-3.75);\n            }\n            this.refreshActiveObj();\n            if (!isNullOrUndefined(activeObjShape)) {\n                if (activeObjShape === 'custom') {\n                    var endPoint = { x: this.lowerCanvas.width - this.pannEnd.startX, y: this.lowerCanvas.height - this.pannEnd.startY };\n                    this.activeObj.activePoint = { startX: this.pannStart.startX, startY: this.pannStart.startY, endX: endPoint.x,\n                        endY: endPoint.y, width: endPoint.x - this.pannStart.startX, height: endPoint.y - this.pannStart.startY };\n                    this.updateActiveObject(this.calcRatio(), this.activeObj.activePoint, this.activeObj);\n                    this.drawObject('duplicate', this.activeObj);\n                }\n                else {\n                    this.select(activeObjShape);\n                }\n                this.refreshToolbar('main', true, true);\n            }\n            if (!this.isUndoRedo) {\n                this.updateUndoRedoColl('zoom', zoomState, this.objColl);\n            }\n            this.isUndoRedo = false;\n            var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n            if (!isNullOrUndefined(zoomOut) && this.factor === 1) {\n                zoomOut.classList.add('e-disabled');\n            }\n            else if (!isNullOrUndefined(zoomOut)) {\n                zoomOut.classList.remove('e-disabled');\n            }\n        }\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - the radius x point for the ellipse.\n     * @param {number} radiusY - the radius y point for the ellipse.\n     * @param {number} strokeWidth - the stroke width of ellipse.\n     * @param {string} strokeColor - the stroke color of ellipse.\n     * @param {string} fillColor - the fill color of the ellipse.\n     * @returns {boolean}.\n     *\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * * var imageObj = new ImageEditor({\n     * created: () => {\n     * imageObj.drawEllipse(10, 10, 40, 60);\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor) {\n        var isEllipse = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.imgDataColl.length > 0 && inRange) {\n            isEllipse = true;\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: this.activeObj, currentShapeSettings: this.activeObj };\n            this.trigger('shapeChanging', shapeChangingArgs);\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: x, y: y };\n            this.drawShape('circle', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY);\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of line.\n     * @param {number} startY  Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor) {\n        var isLine = false;\n        var inRange = this.isPointsInRange(startX, startY);\n        if (!this.disabled && this.imgDataColl.length > 0 && inRange) {\n            isLine = true;\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: this.activeObj, currentShapeSettings: this.activeObj };\n            this.trigger('shapeChanging', shapeChangingArgs);\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: startX, y: startY };\n            var width = endX - startX;\n            var height = endY - startY;\n            this.drawShape('line', strokeWidth, strokeColor, null, start, width, height);\n        }\n        return isLine;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - the fill color of the rectangle.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor) {\n        var isRectangle = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.imgDataColl.length > 0 && inRange) {\n            isRectangle = true;\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: this.activeObj,\n                currentShapeSettings: this.activeObj };\n            this.trigger('shapeChanging', shapeChangingArgs);\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: x, y: y };\n            this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height);\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @returns {boolean}.\n     *\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.drawText(10, 10, 'Syncfusion', 'Arial', 12, true, true, '#000');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     *\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color) {\n        var isText = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.imgDataColl.length > 0 && inRange) {\n            isText = true;\n            this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y);\n        }\n        return isText;\n    };\n    /**\n     * Selects a shape based on the given shape id. The id can be got from the public method getShapeSettings.\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.selectShape('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        this.applyActObj();\n        var obj;\n        var isSelected;\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (this.objColl[i].currIndex === id) {\n                obj = extend({}, this.objColl[i], {}, true);\n                break;\n            }\n        }\n        if (isNullOrUndefined(obj)) {\n            isSelected = false;\n        }\n        else {\n            isSelected = true;\n            this.activeObj = obj;\n            this.redrawShape(this.activeObj);\n            this.refreshToolbar('shapes');\n            this.updateToolbarItems(this.calcRatio());\n        }\n        return isSelected;\n    };\n    /**\n     * Deletes a shape based on the given shape id.The id can be got from the public method getShapeSettings.\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.deleteShape('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        this.applyActObj();\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (this.objColl[i].currIndex === id) {\n                this.objColl.splice(i, 1);\n                break;\n            }\n        }\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.drawImage(this.inMemoryCanvas, 0, 0);\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.apply(this.objColl[i].shape, this.objColl[i]);\n            this.refreshActiveObj();\n        }\n        this.refreshToolbar('main');\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.getShapeSetting('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        this.applyActObj();\n        var obj;\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (this.objColl[i].currIndex === id) {\n                obj = extend({}, this.objColl[i], {}, true);\n                break;\n            }\n        }\n        var shapeDetails = this.getObjDetails(obj);\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        this.applyActObj();\n        var shapeDetailsColl = [];\n        for (var i = 0; i < this.objColl.length; i++) {\n            var shapeDetails = this.getObjDetails(this.objColl[i]);\n            shapeDetailsColl.push(shapeDetails);\n        }\n        return shapeDetailsColl;\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        canvasWrapper.style.width = this.element.offsetWidth + 'px';\n        this.lowerCanvas.width = this.upperCanvas.width = this.element.offsetWidth;\n        if (Browser.isDevice) {\n            canvasWrapper.style.height = this.element.offsetHeight - (2 * this.toolbarHeight) - 3 + 'px';\n            this.lowerCanvas.height = this.upperCanvas.height = this.element.offsetHeight - (2 * this.toolbarHeight) - 3;\n        }\n        else {\n            canvasWrapper.style.height = this.element.offsetHeight - this.toolbarHeight - 1 + 'px';\n            this.lowerCanvas.height = this.upperCanvas.height = this.element.offsetHeight - this.toolbarHeight - 1;\n        }\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(SignatureBase));\nexport { ImageEditor };\n"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","ImageEditor","_super","options","element","_this","call","degree","isUndoRedo","dragCanvas","dragElement","keyHistory","flipState","mouseDownPoint","x","y","previousPoint","dragPoint","startX","startY","endX","endY","diffPoint","oldPoint","objColl","undoRedoColl","imgDataColl","strokeSettings","strokeColor","fillColor","strokeWidth","textSettings","text","fontFamily","fontSize","bold","italic","underline","tempStrokeSettings","tempTextSettings","toolbarHeight","pannStart","pannEnd","togglePan","lastX","lastY","dragStart","dragged","factor","currFlipState","touchEndPoint","flipMethod","flipDirection","prevX","currX","prevY","currY","togglePen","rotateMethod","isBoldbtn","isItalicbtn","lastAction","currentToolbar","textStartPoints","fontSizeColl","tempKeyHistory","penDrawColl","allowDrag","textRow","activeObj","activePoint","width","height","flipObjColl","currObjType","shape","isDragging","isActiveObj","isText","isInitialText","isLine","isInitialLine","isCustomCrop","isZoomed","defToolbarItems","baseImgSrc","isTimer","isScreenOriented","ImageEditor_1","preRender","id","getUniqueID","Browser","isDevice","classList","add","themeColl","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","defaultLocale","Crop","ZoomIn","ZoomOut","Transform","Annotation","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontFamily","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Square","Circle","Ellipse","Rectangle","Line","Default","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","l10n","L10n","locale","render","initialize","getModuleName","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","_i","_a","keys","cssClass","removeClass","split","addClass","disabled","unwireEvent","remove","wireEvent","style","theme","updateTheme","upperContext","strokeStyle","fillStyle","destroy","removeAttribute","concat","getAttribute","innerHTML","trigger","createToolbar","createCanvas","updateContext","lowerContext","createSpinner","EventHandler","document","keyDownEventHandler","keyUpEventHandler","upperCanvas","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","lowerCanvas","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","findTextPoint","textBox","window","addEventListener","windowResizeHandler","bind","isIos","info","name","screen","orientation","screenOrientation","toPascalCase","str","strArr","toLowerCase","charAt","toUpperCase","slice","join","canvasWrapper","appendChild","createElement","className","attrs","offsetHeight","inMemoryCanvas","setAttribute","offsetWidth","position","backgroundColor","display","resize","getContext","baseImg","crossorigin","cursor","inMemoryContext","isNullOrUndefined","toolbar","toolbarTemplate","toolbarTemplateFn","toolbarItems","align","type","template","Uploader","push","toolbarArea","getElementById","toolbar_1","uploadItems","selected","getComponent","initToolbarItem","createBottomToolbar","Toolbar","items","created","toolbarType","clicked","defToolbarClicked","createLeftToolbarControls","clientHeight","toolbarElem","initBottomToolbar","getMainToolbarItem","renderAnnotationBtn","renderCropBtn","renderTransformBtn","refreshOverflow","templateID","querySelector","toolbarFn","templateParser","isReact","isAngular","templateColl","nodeType","renderReactTemplates","querySelectorAll","templateCompiler","trim","compile","error","getLeftToolbarItem","isOkBtn","visible","tooltipText","indexOf","prefixIcon","getConstant","tempToolbarItems","processToolbar","len","getRightToolbarItem","isApplyOption","getZoomToolbarItem","processSubToolbar","isToolbar","leftItem","rightItem","mainItem","zoomItem","renderSaveBtn","zoomIn","zoomOut","pan","undefined","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","onchange","fileSelect","proxy","iconCss","drpDownBtn","DropDownButton","open","args","cancelPan","parentElement","top","getBoundingClientRect","select","splitWords","isCropSelection","refreshActiveObj","clearRect","refreshToolbar","item","freeHandDraw","drawShapeText","drawShape","updateToolbarItems","calcRatio","appendTo","cropSelect","ht","transformSelect","imageEditorObj","getInstance","saveItems","export","rotate","flip","getShapesToolbarItem","initShapesToolbarItem","createShapeColor","createShapeBtn","ColorPicker","modeSwitcher","noColor","value","showButtons","mode","change","currentValue","hex","redrawShape","rgba","fillDDB_1","children","toggle","left","offsetLeft","inline","strokeDDB_1","background","strokeWidthItems","ratio","strokeWidthBtn","spanElem_1","drpDownBtn_1","activeBtn","textContent","parseInt","getTextToolbarItem","getFontFamilyItems","getFontSizeItems","initTextToolbarItem","createTextColor","createTextBtn","fontColor","color","strokeDDB_2","fontNameBtn","spanElem_2","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","temp","updateFontStyles","measureText","redrawText","fontStyleBtnElem","span1Elem_1","fontStyleBtn_1","fontStyle","fontWeight","replace","applyFontStyle","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","getFontSizes","fontSizeBtn_1","textStyle","font","rows","getMaxText","parseFloat","setTextSelection","updateActiveObject","Math","round","toString","getTextAreaWidth","tempBold","tempItalic","initZoomToolbarItem","panBtn","zoom","callMainToolbar","transform","cancelItems","crop","redrawActObj","applyActObj","reset","isApplyBtn","isZooming","imageEditorPointsColl","topLeftCircle","clearSelection","gradient","a","applyPenDraw","apply","tempCanvas","tempContext","drawImage","lineWidth","nexP","preP","beginPath","moveTo","points","m","dx1","dx2","dy1","dy2","j","curP","bezierCurveTo","shift","stroke","imgData","getImageData","tempObj","index","operation","splice","putImageData","isCropping","initPenToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","penColor","strokeDDB_3","spanElem_3","drpDownBtn_2","setPenStroke","penStrokeWidth","updateCanvas","wrapperWidth","clientWidth","maxDimension","calcMaxDimension","maxWidth","maxHeight","updateInMemoryCanvas","imageOnLoad","src","onload","toBlob","blob","showSpinner","URL","createObjectURL","hideSpinner","opacity","shapeDegree","updateUndoRedoColl","previousObj","currentObj","inputElement","filesData","files","url","e","transformOrigin","scale","findTextTarget","getStrokeWidth","selFillElem","selStrokeElem","selTextStrokeElem","selPenStrokeElem","strokeWidthElem","fontFamilyElem","fontSizeElem","fontStyleElem","setTimer","timer","preventDefault","setTimeout","currentTarget","clientX","clientY","touches","canvasRatio","minStrokeWidth","maxStrokeWidth","velocity","mouseDownHandler","findTarget","setActivePoint","setCursor","initialDraw","updateActivePoint","drawObject","bbox","applyCurrActObj","shapeChangingArgs","beforeSave","fileName","fileType","cancel","ctrlKey","observableSaveArgs","stopImmediatePropagation","action","previousShapeSettings","currentShapeSettings","textKeyDown","offsetX","pageX","offsetY","pageY","offsetTop","transformedPoint","pt","transitionArgs","startPoint","endPoint","xDiff","yDiff","xxDiff","yyDiff","translate","pt1","pt2","redraw","String","fromCharCode","which","scrollHeight","setTextBoxWidth","adjustToScreen","redrawImg","ctx","xform","DOMMatrix","getTransform","savedTransforms","save","restore","pop","sx","sy","scaleNonUniform","radians","PI","dx","dy","f","m2","multiply","setTransform","DOMPoint","matrixTransform","inverse","m11","m12","m13","m14","m21","m22","m23","m24","zoomImg","clicks","zoomPoint","zoomLevel","pow","handleScroll","delta","wheelDelta","detail","p1","p2","isInside","actObj","extend","setCursorForZoomState","floor","ceil","horTopLine","updateTextFromTextArea","widthColl","max","setTextBoxPos","point","setTextBoxPoints","shapeFlip","JSON","stringify","radius","border","overflow","setTextBoxHeight","textBoxTop","textBoxWidth","letterWidth","textWidth","textHeight","abs","selectInfo","shapeResizingArgs","shapeMovingArgs","updateNWPoints","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","percentage","prevDiffX","prevDiffY","min","maxText","newScale","getScaleRatio","isTextBox","maxi","maxStr","setDragLimit","lineDraw","shapeCircle","canvasDraw","selectionWidth","selectionHeight","fillRect","tempWidth","ellipse","closePath","arc","clip","drawOuterSelection","isInitialDraw","isCropCircle","getZoomShape","rect","topRightCircle","bottomLeftCircle","bottomRightCircle","fill","drawCenterCircles","obj","canvas","isCropRatio","drawCropRatio","isCrop","drawShapeObj","actPoint","isMouseMove","horCircleWidth","verCircleHeight","horBottomLine","verLeftLine","verRightLine","topCenterCircle","centerLeftCircle","centerRightCircle","bottomCenterCircle","currentShape","horLineWidth","verLineHeight","drawSquareLines","shapeLine","shapeText","drawSelection","tempLineWidth","lineTo","lineHeight","yPoint","updateActPoint","rotateText","fillText","k","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","findTargetObj","updateCursorStyles","diffX","currImgData","flippedText","isResize","setDragDirection","calcShapeRatio","arcRadius","visibleWidth","visibleHeight","centerX","centerY","originalWidth","originalHeight","presetRatio","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","widthRatio","heightRatio","canvasMaxWidth","canvasMaxHeight","widthScale","heightScale","cssMaxWidth","cssMaxHeight","setMaximumDimension","newWidth","newHeight","setCursorFromObj","downloadImg","href","download","body","documentElement","click","parentNode","removeChild","toSVGImg","dataUrl","toDataURL","svg","createElementNS","img","setAttributeNS","data","svgDataUrl","btoa","toBlobFn","blobUrl","addLetter","letter","drawBaseImg","calcPrevRatio","oldWidthRatio","oldHeightRatio","textFlipDegree","redrawSelection","redrawObj","updateCurrentActiveObjPoint","currActObjIndex","oldRatio","currIndex","calcCurrPoints","isActObj","splitWords_2","tempObjColl","proxy_1","setCenterPoints","renderWidth","renderHeight","start","tempHeight","drawPen","context","getObjDetails","shapeDetails","isPointsInRange","inRange","proxy_2","zoomedRotate","updateInMemoryContext","cssObj","getComputedStyle","imgData_1","globalCompositeOperation","blobUrl_1","data_1","globalAlpha","direction","activeObjShape","toolbar_10","update","isRotate","saved_1","cropShape","zoomState","drawEllipse","radiusX","radiusY","isEllipse","drawLine","drawRectangle","isRectangle","drawText","selectShape","isSelected","deleteShape","getShapeSetting","getShapeSettings","shapeDetailsColl","Property","Event","NotifyPropertyChanges","SignatureBase"],"mappings":"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"}